<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Condon-Shortley (1935) ¬∑ SphericalFunctions.jl</title><meta name="title" content="Condon-Shortley (1935) ¬∑ SphericalFunctions.jl"/><meta property="og:title" content="Condon-Shortley (1935) ¬∑ SphericalFunctions.jl"/><meta property="twitter:title" content="Condon-Shortley (1935) ¬∑ SphericalFunctions.jl"/><meta name="description" content="Documentation for SphericalFunctions.jl."/><meta property="og:description" content="Documentation for SphericalFunctions.jl."/><meta property="twitter:description" content="Documentation for SphericalFunctions.jl."/><meta property="og:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/condon_shortley_1935/"/><meta property="twitter:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/condon_shortley_1935/"/><link rel="canonical" href="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/condon_shortley_1935/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../../assets/extras.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">SphericalFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../transformations/"><span>$s$</span>-SHT Transformations</a></li><li><a class="tocitem" href="../../../wigner_matrices/">Wigner&#39;s <span>$ùîá$</span> and <span>$d$</span> matrices</a></li><li><a class="tocitem" href="../../../sYlm/"><span>${}_{s}Y_{\ell,m}$</span> functions</a></li><li><a class="tocitem" href="../../../operators/">Differential operators</a></li><li><a class="tocitem" href="../../../utilities/">Utilities</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../../internal/">Internal functions</a></li><li><a class="tocitem" href="../../../functions/">Complete function list</a></li></ul></li><li><span class="tocitem">Conventions</span><ul><li><a class="tocitem" href="../../summary/">Summary</a></li><li><a class="tocitem" href="../../details/">Details</a></li><li><a class="tocitem" href="../">Comparisons</a></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox" checked/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Comparisons</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../blanchet_2024/">Blanchet (2024)</a></li><li><a class="tocitem" href="../cohen_tannoudji_1991/">Cohen-Tannoudji (1991)</a></li><li class="is-active"><a class="tocitem" href>Condon-Shortley (1935)</a><ul class="internal"><li><a class="tocitem" href="#Implementing-formulas"><span>Implementing formulas</span></a></li><li><a class="tocitem" href="#Tests"><span>Tests</span></a></li></ul></li><li><a class="tocitem" href="../lalsuite_2025/">LALSuite (2025)</a></li><li><a class="tocitem" href="../ninja_2011/">NINJA (2011)</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../calculations/euler_angular_momentum/"><span>$L_j$</span> and <span>$R_j$</span> with Euler angles</a></li></ul></li></ul></li><li><span class="tocitem">Notes</span><ul><li><a class="tocitem" href="../../../notes/H_recursions/">Algorithm for computing <span>$H$</span></a></li><li><a class="tocitem" href="../../../notes/sampling_theorems/">Sampling theorems and transformations of spin-weighted spherical harmonics</a></li></ul></li><li><a class="tocitem" href="../../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Conventions</a></li><li><a class="is-disabled">Comparisons</a></li><li class="is-active"><a href>Condon-Shortley (1935)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Condon-Shortley (1935)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl/blob/main/docs/literate_input/conventions/comparisons/condon_shortley_1935.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Condon-Shortley-(1935)"><a class="docs-heading-anchor" href="#Condon-Shortley-(1935)">Condon-Shortley (1935)</a><a id="Condon-Shortley-(1935)-1"></a><a class="docs-heading-anchor-permalink" href="#Condon-Shortley-(1935)" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Summary</header><div class="admonition-body"><p>Condon and Shortley&#39;s definition of the spherical harmonics agrees with the definition used in the <code>SphericalFunctions</code> package.</p><p>TODO: Compare angular-momentum operators.</p></div></div><p><a href="../../../references/#CondonShortley_1935">Condon and Shortley&#39;s &quot;The Theory Of Atomic Spectra&quot;</a> is the standard reference for the &quot;Condon-Shortley phase convention&quot;.  Though some references are not very clear about precisely what they mean by that phrase, it seems clear that the original meaning revolved around the idea that the angular-momentum raising and lowering operators have eigenvalues that are <em>real and positive</em> when acting on the spherical harmonics.  Specifically, they discuss the phase ambiguity of the eigenfunction <span>$\psi$</span> ‚Äî which includes spherical harmonics indexed by <span>$j$</span> and <span>$m$</span> for the angular part ‚Äî in section 3¬≥ (page 48).  This culminates in Eq. (3) of that section, which is as explicit as they get:</p><p class="math-container">\[\left( J_x \pm i J_y \right) \psi(\gamma j m)
=
\hbar \sqrt{(j \mp m)(j \pm m + 1)} \psi(\gamma j m \pm 1).\]</p><p>This eliminates any <em>relative</em> phase ambiguity between modes with neighboring <span>$m$</span> values, and specifically determines what factors of <span>$(-1)^m$</span> should be included in the definition of the spherical harmonics.</p><p>To avoid re-introducing ambiguity, we can just look at the actual spherical harmonics they define.  The method we use here is as direct and explicit as possible.  In particular, Condon and Shortley provide a formula for the œÜ=0 part in terms of iterated derivatives of a power of sin(Œ∏).  Rather than expressing these derivatives in terms of the Legendre polynomials ‚Äî which would subject us to another round of ambiguity ‚Äî the functions in this module use automatic differentiation to compute the derivatives explicitly.</p><p>Condon and Shortley are not very explicit about the meaning of the spherical coordinates, but they do describe them as &quot;spherical polar coordinates <span>$r, \theta, \varphi$</span>&quot;. Immediately before equation (1) of section 4¬≥ (page 50), they define the angular-momentum operator</p><p class="math-container">\[L_z = -i \hbar \frac{\partial}{\partial \varphi},\]</p><p>which agrees with <a href="../../calculations/euler_angular_momentum/#L-operators-in-spherical-coordinates">our expression</a>.  This is followed by equation (8):</p><p class="math-container">\[\begin{aligned}
L_x + i L_y &amp;= \hbar e^{i\varphi} \left(
  \frac{\partial}{\partial \theta}
  + i \cot\theta \frac{\partial}{\partial \varphi}
\right) \\
L_x - i L_y &amp;= \hbar e^{-i\varphi} \left(
  -\frac{\partial}{\partial \theta}
  + i \cot\theta \frac{\partial}{\partial \varphi}
\right),
\end{aligned}\]</p><p>which also agrees with <a href="../../calculations/euler_angular_momentum/#L_{\\pm}-operators-in-spherical-coordinates">our results.</a> We can infer that the definitions of the spherical coordinates are consistent with ours.</p><p>Condon and Shortley do not give an expression for the Wigner D-matrices.</p><h2 id="Implementing-formulas"><a class="docs-heading-anchor" href="#Implementing-formulas">Implementing formulas</a><a id="Implementing-formulas-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-formulas" title="Permalink"></a></h2><p>We begin by writing code that implements the formulas from Condon-Shortley.  We encapsulate the formulas in a module so that we can test them against the <code>SphericalFunctions</code> package.</p><pre><code class="language-julia hljs">module CondonShortley</code></pre><p>We&#39;ll also use some predefined utilities to make the code look more like the equations.</p><pre><code class="language-julia hljs">import ..ConventionsUtilities: ùíæ, ‚ùó, d ≤sin¬≤·µèŒ∏dcosŒ∏ ≤</code></pre><p>Equation (12) of section 4¬≥ (page 51) writes the solution to the three-dimensional Laplace equation in spherical coordinates as</p><p class="math-container">\[\psi(\gamma, \ell, m_\ell)
=
B(\gamma, \ell) \Theta(\ell, m_\ell) \Phi(m_\ell),\]</p><p>where <span>$B$</span> is independent of <span>$\theta$</span> and <span>$\varphi$</span>, and <span>$\gamma$</span> represents any number of eigenvalues required to specify the state.  More explicitly, below Eq. (5) of section 5‚Åµ (page 127), they specifically define the spherical harmonics as</p><p class="math-container">\[\phi(\ell, m_\ell) = \Theta(\ell, m_\ell) \Phi(m_\ell).\]</p><p>One quirk of their notation is that the dependence on <span>$\theta$</span> and <span>$\varphi$</span> is implicit in their functions; we make it explicit, as Julia requires:</p><pre><code class="language-julia hljs">function ùúô(‚Ñì, m‚Çó, ùúÉ, œÜ)
    Œò(‚Ñì, m‚Çó, ùúÉ) * Œ¶(m‚Çó, œÜ)
end</code></pre><p>The <span>$\varphi$</span> part is given by equation (5) of section 4¬≥ (page 50):</p><p class="math-container">\[\Phi(m_\ell)
=
\frac{1}{\sqrt{2\pi}} e^{i m_\ell \varphi}.\]</p><p>Again, we make the dependence on <span>$\varphi$</span> explicit, and we capture its type to ensure that we don&#39;t lose precision when converting œÄ to a floating-point number.</p><pre><code class="language-julia hljs">function Œ¶(m‚Çó, œÜ::T) where {T}
    1 / ‚àö(2T(œÄ)) * exp(ùíæ * m‚Çó * œÜ)
end</code></pre><p>Equation (15) of section 4¬≥ (page 52) gives the <span>$\theta$</span> dependence as</p><p class="math-container">\[\Theta(\ell, m)
=
(-1)^\ell
\sqrt{\frac{(2\ell+1)}{2} \frac{(\ell+m)!}{(\ell-m)!}}
\frac{1}{2^\ell \ell!}
\frac{1}{\sin^m \theta}
\frac{d^{\ell-m}}{d(\cos\theta)^{\ell-m}} \sin^{2\ell}\theta.\]</p><p>Again, we make the dependence on <span>$\theta$</span> explicit, and we capture its type to ensure that we don&#39;t lose precision when converting the factorials to a floating-point number.</p><pre><code class="language-julia hljs">function Œò(‚Ñì, m, ùúÉ::T) where {T}
    (-1)^‚Ñì * T(‚àö(((2‚Ñì+1) * (‚Ñì+m)‚ùó) / (2 * (‚Ñì - m)‚ùó)) * (1 / (2^‚Ñì * (‚Ñì)‚ùó))) *
    (1 / sin(ùúÉ)^T(m)) * d ≤sin¬≤·µèŒ∏dcosŒ∏ ≤(j=‚Ñì-m, k=‚Ñì, Œ∏=ùúÉ)
end</code></pre><p>It may be helpful to check some values against explicit formulas for the first few spherical harmonics as given by Condon-Shortley in the footnote to Eq. (15) of Sec. 4¬≥ (page 52).  Note the subtle difference between the character <code>Œò</code> defining the function above and the character <code>œ¥</code> defining the function below.</p><pre><code class="language-julia hljs">œ¥(‚Ñì, m, ùúÉ) = œ¥(Val(‚Ñì), Val(m), ùúÉ)
œ¥(::Val{0}, ::Val{0}, ùúÉ) = ‚àö(1/2)
œ¥(::Val{1}, ::Val{0}, ùúÉ) = ‚àö(3/2) * cos(ùúÉ)
œ¥(::Val{2}, ::Val{0}, ùúÉ) = ‚àö(5/8) * (2cos(ùúÉ)^2 - sin(ùúÉ)^2)
œ¥(::Val{3}, ::Val{0}, ùúÉ) = ‚àö(7/8) * (2cos(ùúÉ)^3 - 3cos(ùúÉ)sin(ùúÉ)^2)
œ¥(::Val{1}, ::Val{+1}, ùúÉ) = -‚àö(3/4) * sin(ùúÉ)
œ¥(::Val{1}, ::Val{-1}, ùúÉ) = +‚àö(3/4) * sin(ùúÉ)
œ¥(::Val{2}, ::Val{+1}, ùúÉ) = -‚àö(15/4) * cos(ùúÉ) * sin(ùúÉ)
œ¥(::Val{2}, ::Val{-1}, ùúÉ) = +‚àö(15/4) * cos(ùúÉ) * sin(ùúÉ)
œ¥(::Val{3}, ::Val{+1}, ùúÉ) = -‚àö(21/32) * (4cos(ùúÉ)^2*sin(ùúÉ) - sin(ùúÉ)^3)
œ¥(::Val{3}, ::Val{-1}, ùúÉ) = +‚àö(21/32) * (4cos(ùúÉ)^2*sin(ùúÉ) - sin(ùúÉ)^3)
œ¥(::Val{2}, ::Val{+2}, ùúÉ) = ‚àö(15/16) * sin(ùúÉ)^2
œ¥(::Val{2}, ::Val{-2}, ùúÉ) = ‚àö(15/16) * sin(ùúÉ)^2
œ¥(::Val{3}, ::Val{+2}, ùúÉ) = ‚àö(105/16) * cos(ùúÉ) * sin(ùúÉ)^2
œ¥(::Val{3}, ::Val{-2}, ùúÉ) = ‚àö(105/16) * cos(ùúÉ) * sin(ùúÉ)^2
œ¥(::Val{3}, ::Val{+3}, ùúÉ) = -‚àö(35/32) * sin(ùúÉ)^3
œ¥(::Val{3}, ::Val{-3}, ùúÉ) = +‚àö(35/32) * sin(ùúÉ)^3</code></pre><p>Condon and Shortley do not give an expression for the Wigner D-matrices, but the convention for spherical harmonics is what they are known for, so this will suffice.</p><pre><code class="language-julia hljs">end  # module CondonShortley</code></pre><h2 id="Tests"><a class="docs-heading-anchor" href="#Tests">Tests</a><a id="Tests-1"></a><a class="docs-heading-anchor-permalink" href="#Tests" title="Permalink"></a></h2><p>We can now test the functions against the equivalent functions from the <code>SphericalFunctions</code> package.  We will need to test approximate floating-point equality, so we set absolute and relative tolerances (respectively) in terms of the machine epsilon:</p><pre><code class="language-julia hljs">œµ‚Çê = 100eps()
œµ·µ£ = 1000eps()</code></pre><p>The explicit formulas will be a good preliminary test.  In this case, the formulas are only given up to</p><pre><code class="language-julia hljs">‚Ñì‚Çò‚Çê‚Çì = 3</code></pre><p>so we test up to that point, and just compare the general form to the explicit formulas ‚Äî again, noting the subtle difference between the characters <code>Œò</code> and <code>œ¥</code>.  Note that the <span>$1/\sin\theta$</span> factor in the general form will cause problems at the poles, so we avoid the poles by using <code>Œ≤range</code> with a small offset:</p><pre><code class="language-julia hljs">for Œ∏ ‚àà Œ∏range(; avoid_poles=œµ‚Çê/10)
    for (‚Ñì, m) ‚àà ‚Ñìmrange(‚Ñì‚Çò‚Çê‚Çì)
        @test CondonShortley.œ¥(‚Ñì, m, Œ∏) ‚âà CondonShortley.Œò(‚Ñì, m, Œ∏) atol=œµ‚Çê rtol=œµ·µ£
    end
end</code></pre><p>Finally, we can test Condon-Shortley&#39;s full expressions for spherical harmonics against the <code>SphericalFunctions</code> package.  We will only test up to</p><pre><code class="language-julia hljs">‚Ñì‚Çò‚Çê‚Çì = 4</code></pre><p>because the formulas are very slow, and this will be sufficient to sort out any sign or normalization differences, which are the most likely source of error.</p><pre><code class="language-julia hljs">for (Œ∏, œï) ‚àà Œ∏œïrange(; avoid_poles=œµ‚Çê/40)
    for (‚Ñì, m) ‚àà ‚Ñìmrange(‚Ñì‚Çò‚Çê‚Çì)
        @test CondonShortley.ùúô(‚Ñì, m, Œ∏, œï) ‚âà SphericalFunctions.Y(‚Ñì, m, Œ∏, œï) atol=œµ‚Çê rtol=œµ·µ£
    end
end</code></pre><p>This successful test shows that the function <span>$\phi$</span> defined by Condon and Shortley agrees with the spherical harmonics defined by the <code>SphericalFunctions</code> package.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cohen_tannoudji_1991/">¬´ Cohen-Tannoudji (1991)</a><a class="docs-footer-nextpage" href="../lalsuite_2025/">LALSuite (2025) ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Monday 7 April 2025 17:27">Monday 7 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
