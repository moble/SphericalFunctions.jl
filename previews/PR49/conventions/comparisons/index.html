<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparisons ¬∑ SphericalFunctions.jl</title><meta name="title" content="Comparisons ¬∑ SphericalFunctions.jl"/><meta property="og:title" content="Comparisons ¬∑ SphericalFunctions.jl"/><meta property="twitter:title" content="Comparisons ¬∑ SphericalFunctions.jl"/><meta name="description" content="Documentation for SphericalFunctions.jl."/><meta property="og:description" content="Documentation for SphericalFunctions.jl."/><meta property="twitter:description" content="Documentation for SphericalFunctions.jl."/><meta property="og:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/"/><meta property="twitter:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/"/><link rel="canonical" href="https://moble.github.io/SphericalFunctions.jl/stable/conventions/comparisons/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/extras.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SphericalFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../transformations/"><span>$s$</span>-SHT Transformations</a></li><li><a class="tocitem" href="../../wigner_matrices/">Wigner&#39;s <span>$ùîá$</span> and <span>$d$</span> matrices</a></li><li><a class="tocitem" href="../../sYlm/"><span>${}_{s}Y_{\ell,m}$</span> functions</a></li><li><a class="tocitem" href="../../operators/">Differential operators</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../internal/">Internal functions</a></li><li><a class="tocitem" href="../../functions/">Complete function list</a></li></ul></li><li><span class="tocitem">Conventions</span><ul><li><a class="tocitem" href="../summary/">Summary</a></li><li><a class="tocitem" href="../details/">Details</a></li><li class="is-active"><a class="tocitem" href>Comparisons</a><ul class="internal"><li><a class="tocitem" href="#Cohen-Tannoudji-(1991)"><span>Cohen-Tannoudji (1991)</span></a></li><li><a class="tocitem" href="#Condon-Shortley-(1935)"><span>Condon-Shortley (1935)</span></a></li><li><a class="tocitem" href="#Edmonds-(1960)"><span>Edmonds (1960)</span></a></li><li><a class="tocitem" href="#Goldberg-et-al.-(1967)"><span>Goldberg et al. (1967)</span></a></li><li><a class="tocitem" href="#Griffiths-(1995)"><span>Griffiths (1995)</span></a></li><li><a class="tocitem" href="#LALSuite"><span>LALSuite</span></a></li><li><a class="tocitem" href="#Le-Bellac-(2006)"><span>Le Bellac (2006)</span></a></li><li><a class="tocitem" href="#Mathematica"><span>Mathematica</span></a></li><li><a class="tocitem" href="#Newman-Penrose"><span>Newman-Penrose</span></a></li><li><a class="tocitem" href="#NINJA"><span>NINJA</span></a></li><li><a class="tocitem" href="#Sakurai-(1994)"><span>Sakurai (1994)</span></a></li><li><a class="tocitem" href="#Scipy"><span>Scipy</span></a></li><li><a class="tocitem" href="#Shankar-(1994)"><span>Shankar (1994)</span></a></li><li><a class="tocitem" href="#SymPy"><span>SymPy</span></a></li><li><a class="tocitem" href="#Thorne"><span>Thorne</span></a></li><li><a class="tocitem" href="#Torres-del-Castillo-(2003)"><span>Torres del Castillo (2003)</span></a></li><li><a class="tocitem" href="#Varshalovich-et-al.-(1988)"><span>Varshalovich et al. (1988)</span></a></li><li><a class="tocitem" href="#Wikipedia"><span>Wikipedia</span></a></li><li><a class="tocitem" href="#Wigner"><span>Wigner</span></a></li><li><a class="tocitem" href="#Zettili-(2009)"><span>Zettili (2009)</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../literate_output/euler_angular_momentum/"><span>$L_j$</span> and <span>$R_j$</span> with Euler angles</a></li></ul></li></ul></li><li><span class="tocitem">Notes</span><ul><li><a class="tocitem" href="../../notes/H_recursions/">Algorithm for computing <span>$H$</span></a></li><li><a class="tocitem" href="../../notes/sampling_theorems/">Sampling theorems and transformations of spin-weighted spherical harmonics</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Conventions</a></li><li class="is-active"><a href>Comparisons</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparisons</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl/blob/main/docs/src/conventions/comparisons.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparisons"><a class="docs-heading-anchor" href="#Comparisons">Comparisons</a><a id="Comparisons-1"></a><a class="docs-heading-anchor-permalink" href="#Comparisons" title="Permalink"></a></h1><p>Here, we compare our conventions to other sources, including references in the literature as well as other software that implements some of these.  Each of these comparisons is also performed explicitly in <a href="https://github.com/moble/SphericalFunctions.jl/tree/main/test/conventions">this package&#39;s test suite</a>.</p><p>Among the items that would be good to compare are the following, when actually used by any of these sources:</p><ul><li>Quaternions<ul><li>Order of components</li><li>Basis and multiplication table</li><li>Operation as rotations</li></ul></li><li>Euler angles</li><li>Spherical coordinates</li><li>Angular momentum operators<ul><li>Fundamental definitions</li><li>Expression in terms of spherical coordinates</li><li>Expression in terms of Euler angles</li><li>Right-derivative form</li></ul></li><li>Spherical harmonics<ul><li>Condon-Shortley phase</li><li>Formula</li></ul></li><li>Spin-weighted spherical harmonics<ul><li>Behavior under rotation</li></ul></li><li>Wigner D-matrices<ul><li>Representation √† la <span>$\langle \ell, m&#39; | e^{-i \alpha J_z} e^{-i \beta J_y} e^{-i \gamma J_z} | \ell, m \rangle$</span></li><li>Rotation of spherical harmonics</li><li>Order of indices</li><li>Conjugation</li><li>Function of rotation or inverse rotation</li><li>Formula</li></ul></li></ul><p>One major result of this is that almost everyone since 1935 has used the same exact expression for the (scalar) spherical harmonics.</p><p>When choosing my conventions, I intend to prioritize consistency (to the extent that any of these references actually have anything to say about the above items) with the following sources, in order:</p><ol><li>LALSuite</li><li>NINJA</li><li>Thorne / MTW</li><li>Goldberg</li><li>Newman-Penrose</li><li>Wikipedia</li><li>Sakurai</li><li>Shankar</li><li>Zettili</li></ol><p>I think that should be sufficient to find a consensus on conventions for each of the above ‚Äî with the possible exception of quaternions, for which I have my own strong opinions.</p><h2 id="Cohen-Tannoudji-(1991)"><a class="docs-heading-anchor" href="#Cohen-Tannoudji-(1991)">Cohen-Tannoudji (1991)</a><a id="Cohen-Tannoudji-(1991)-1"></a><a class="docs-heading-anchor-permalink" href="#Cohen-Tannoudji-(1991)" title="Permalink"></a></h2><p><a href="../../references/#CohenTannoudji_1991">Cohen-Tannoudji <em>et al.</em> [18]</a> defines spherical coordinates in the usual (physicist&#39;s) way in Chapter VI.  He then computes the angular-momentum operators as [Eqs. (D-5)]</p><p class="math-container">\[\begin{aligned}
L_x &amp;= i \hbar \left(
    \sin\phi \frac{\partial} {\partial \theta}
    + \frac{\cos\phi}{\tan\theta} \frac{\partial} {\partial \phi}
\right),
\\
L_y &amp;= i \hbar \left(
    -\cos\phi \frac{\partial} {\partial \theta}
    + \frac{\sin\phi}{\tan\theta} \frac{\partial} {\partial \phi}
\right),
\\
L_z &amp;= \frac{\hbar}{i} \frac{\partial} {\partial \phi}.
\end{aligned}\]</p><p>He derives the spherical harmonics in two ways and gets two different, but equivalent, expressions in Complement <span>$\mathrm{A}_{\mathrm{VI}}$</span>.  The first is Eq. (26)</p><p class="math-container">\[Y_{l}^{m}(\theta, \phi)
=
\frac{(-1)^l}{2^l l!} \sqrt{\frac{(2l+1)}{4\pi} \frac{(l+m)!}{(l-m)!}}
e^{i m \phi} (\sin \theta)^{-m}
\frac{d^{l-m}}{d(\cos \theta)^{l-m}} (\sin \theta)^{2l},\]</p><p>while the second is Eq. (30)</p><p class="math-container">\[Y_{l}^{m}(\theta, \phi)
=
\frac{(-1)^{l+m}}{2^l l!} \sqrt{\frac{(2l+1)}{4\pi} \frac{(l-m)!}{(l+m)!}}
e^{i m \phi} (\sin \theta)^m
\frac{d^{l+m}}{d(\cos \theta)^{l+m}} (\sin \theta)^{2l}.\]</p><p>In Complement <span>$\mathrm{B}_{\mathrm{VI}}$</span> he defines a rotation operator <span>$R$</span> as acting on a state such that [Eq. (21)]</p><p class="math-container">\[\langle \mathbf{r} | R | \psi \rangle
=
\langle \mathscr{R}^{-1} \mathbf{r} | \psi \rangle.\]</p><p>For an infinitesimal rotation through angle <span>$d\alpha$</span> about the axis <span>$\mathbf{u}$</span>, he shows [Eq. (49)]</p><p class="math-container">\[R_{\mathbf{u}}(d\alpha) = 1 - \frac{i}{\hbar} d\alpha \mathbf{L}.\mathbf{u}.\]</p><p>Cohen-Tannoudji does not appear to define the Wigner D-matrices.</p><h2 id="Condon-Shortley-(1935)"><a class="docs-heading-anchor" href="#Condon-Shortley-(1935)">Condon-Shortley (1935)</a><a id="Condon-Shortley-(1935)-1"></a><a class="docs-heading-anchor-permalink" href="#Condon-Shortley-(1935)" title="Permalink"></a></h2><p><a href="../../references/#CondonShortley_1935">Condon and Shortley&#39;s &quot;The Theory Of Atomic Spectra&quot;</a> is the standard reference for the &quot;Condon-Shortley phase convention&quot; ‚Äî though no one is ever too clear about precisely what that means.  To avoid ambiguity, we can just look at the actual spherical harmonics they define.</p><p>They are not very explicit about the meaning of the spherical coordinates, but they do describe them as &quot;spherical polar coordinates <span>$r, \theta, \varphi$</span>&quot; immediately before equation (1) of section 4¬≥ (page 50),</p><p class="math-container">\[L_z = -i \hbar \frac{\partial}{\partial \varphi},\]</p><p>followed by equation (8):</p><p class="math-container">\[\begin{aligned}
L_x + i L_y &amp;= \hbar e^{i\varphi} \left(
  \frac{\partial}{\partial \theta}
  + i \cot\theta \frac{\partial}{\partial \varphi}
\right) \\
L_x - i L_y &amp;= \hbar e^{-i\varphi} \left(
  -\frac{\partial}{\partial \theta}
  + i \cot\theta \frac{\partial}{\partial \varphi}
\right).
\end{aligned}\]</p><p>Equation (15) of section 4¬≥ (page 52) gives the <span>$\theta$</span> dependence of the spherical harmonic as</p><p class="math-container">\[\Theta(\ell, m)
=
(-1)^\ell
\sqrt{\frac{(2\ell+1)}{2} \frac{(\ell+m)!}{(\ell-m)!}}
\frac{1}{2^\ell \ell!}
\frac{1}{\sin^m \theta}
\frac{d^{\ell-m}}{d(\cos\theta)^{\ell-m}} \sin^{2\ell}\theta.\]</p><p>The <span>$\varphi$</span> part is given by equation (5) of section 4¬≥ (page 50):</p><pre><code class="language-julia hljs">1 / ‚àö(2T(œÄ)) * exp(ùíæ * m‚Çó * œÜ)</code></pre><p class="math-container">\[\Phi(m_\ell)
=
\frac{1}{\sqrt{2\pi}} e^{i m_\ell \varphi}.\]</p><p>Equation (12) of section 4¬≥ (page 51) writes the solution to the three-dimensional Laplace equation in spherical coordinates as</p><p class="math-container">\[\psi(\gamma, \ell, m_\ell)
=
B(\gamma, \ell) \Theta(\ell, m_\ell) \Phi(m_\ell),\]</p><p>where <span>$B$</span> is independent of <span>$\theta$</span> and <span>$\varphi$</span>, and <span>$\gamma$</span> represents any number of eigenvalues required to specify the state. Thus, we take the angular factors, normalized, to define the spherical harmonics.  The result is that the original Condon-Shortley spherical harmonics agree perfectly with the ones computed by this package.</p><p>Condon and Shortley do not give an expression for the Wigner D-matrices.</p><h2 id="Edmonds-(1960)"><a class="docs-heading-anchor" href="#Edmonds-(1960)">Edmonds (1960)</a><a id="Edmonds-(1960)-1"></a><a class="docs-heading-anchor-permalink" href="#Edmonds-(1960)" title="Permalink"></a></h2><p><a href="../../references/#Edmonds_2016">Edmonds [20]</a> is a standard reference for the theory of angular momentum.</p><p>In Sec. 1.3 he actually does a fair job of defining the Euler angles. The upshot is that his definition agrees with ours, though he uses the &quot;active&quot; definition style.  That is, the rotations are to be performed successively in order:</p><blockquote><ol><li><p>A rotation <span>$\alpha(0 \leq \alpha &lt; 2\pi)$</span> about the <span>$z$</span>-axis, bringing the frame of axes from the initial position <span>$S$</span> into the position <span>$S&#39;$</span>.  The axis of this rotation is commonly called the <em>vertical</em>.</p></li><li><p>A rotation <span>$\beta(0 \leq \beta &lt; \pi)$</span> about the <span>$y$</span>-axis of the frame <span>$S&#39;$</span>, called the <em>line of nodes</em>.  Note that its position is in general different from the initial position of the <span>$y$</span>-axis of the frame <span>$S$</span>. The resulting position of the frame of axes is symbolized by <span>$S&#39;&#39;$</span>.</p></li><li><p>A rotation <span>$\gamma(0 \leq \gamma &lt; 2\pi)$</span> about the <span>$z$</span>-axis of the frame of axes <span>$S&#39;&#39;$</span>, called the <em>figure axis</em>; the position of this axis depends on the previous rotations <span>$\alpha$</span> and <span>$\beta$</span>.  The final position of the frame is symbolized by <span>$S&#39;&#39;&#39;$</span>.</p></li></ol></blockquote><p>I would simply write the &quot;<span>$y$</span>-axis of the frame <span>$S&#39;$</span>&quot; as <span>$y&#39;$</span>, and so on.  In quaternionic language, I would write these rotations as <span>$\exp[\gamma ùê§&#39;&#39;/2]\, \exp[\beta ùê£&#39;/2]\, \exp[\alpha ùê§/2]$</span>.  But we also have</p><p class="math-container">\[\exp[\beta ùê£&#39;/2] = \exp[\alpha ùê§/2]\, \exp[\beta ùê£/2]\, \exp[-\alpha ùê§/2]\]</p><p>so we can just swap the <span>$\alpha$</span> rotation with the <span>$\beta$</span> rotation while dropping the prime from <span>$ùê£&#39;$</span>.  We can do a similar trick swapping the <span>$\alpha$</span> and <span>$\beta$</span> rotations with the <span>$\gamma$</span> rotation while dropping the double prime from <span>$ùê§&#39;&#39;$</span>. That is, an easy calculation shows that</p><p class="math-container">\[\exp[\gamma ùê§&#39;&#39;/2]\, \exp[\beta ùê£&#39;/2]\, \exp[\alpha ùê§/2]
=
\exp[\alpha ùê§/2]\, \exp[\beta ùê£/2]\, \exp[\gamma ùê§/2],\]</p><p>which is precisely our definition.</p><p>The spherical coordinates are implicitly defined by</p><blockquote><p>It should be noted that the polar coordinates <span>$\varphi, \theta$</span> with respect to the original frame <span>$S$</span> of the <span>$z$</span>-axis in its final position are identical with the Euler angles <span>$\alpha, \beta$</span> respectively.</p></blockquote><p>Again, this agrees with our definition.</p><p>His expression for the angular-momentum operator in Euler angles ‚Äî¬†Eq. (2.2.2) ‚Äî agrees with ours:</p><p class="math-container">\[\begin{aligned}
L_x &amp;= -i \hbar \left\{
    -\frac{\cos\alpha}{\tan\beta} \frac{\partial} {\partial \alpha}
    - \sin\alpha \frac{\partial} {\partial \beta}
    + \frac{\cos\alpha}{\sin\beta} \frac{\partial} {\partial \gamma}
\right\},
\\
L_y &amp;= -i \hbar \left\{
    -\frac{\sin\alpha}{\tan\beta} \frac{\partial} {\partial \alpha}
    + \cos\alpha \frac{\partial} {\partial \beta}
    +\frac{\sin\alpha}{\sin\beta} \frac{\partial} {\partial \gamma}
\right\},
\\
L_z &amp;= -i \hbar \frac{\partial} {\partial \alpha}.
\end{aligned}\]</p><p>(The corresponding restriction to spherical coordinates also precisely agrees with our results, with the extra factor of <span>$\hbar$</span>.)</p><p>Unfortunately, there is disagreement over the definition of the Wigner D-matrices.  In Eq. (4.1.12) he defines</p><p class="math-container">\[\mathcal{D}_{\alpha \beta \gamma} =
\exp\big( \frac{i\alpha}{\hbar} J_z\big)
\exp\big( \frac{i\beta}{\hbar} J_y\big)
\exp\big( \frac{i\gamma}{\hbar} J_z\big),\]</p><p>which is the <em>conjugate</em> of most other definitions.</p><h2 id="Goldberg-et-al.-(1967)"><a class="docs-heading-anchor" href="#Goldberg-et-al.-(1967)">Goldberg et al. (1967)</a><a id="Goldberg-et-al.-(1967)-1"></a><a class="docs-heading-anchor-permalink" href="#Goldberg-et-al.-(1967)" title="Permalink"></a></h2><p><a href="../../references/#GoldbergEtAl_1967">Goldberg <em>et al.</em> [21]</a> presented the first paper specifically about spin-weighted spherical harmonics (after <a href="../../references/#Newman_1966">Newman and Penrose [7]</a> introduced them), and the first to relate them to the Wigner D-matrices.</p><p>If we relate two vectors by a rotation matrix as <span>$x&#39;^k = R^{kl} x^l$</span>, then Goldberg et al. define <span>$D$</span> by its action on spherical harmonics [Eq. (3.3)]:</p><p class="math-container">\[Y_{ell,m}(x&#39;) = \sum_{m&#39;} Y_{ell,m&#39;}(x) D^{ell}_{m&#39;,m}\left( R^{-1} \right).\]</p><p>They then define the Euler angles as we do, and write [Eq. (3.4)]</p><p class="math-container">\[D^{\ell}_{m&#39;, m}(\alpha, \beta, \gamma)
\equiv
D^{\ell}_{m&#39;, m}\left( R(\alpha \beta \gamma)^{-1} \right)
=
e^{i m&#39; \gamma} d^{\ell}_{m&#39;, m}(\beta) e^{i m \alpha}.\]</p><p>Finally, they derive [Eq. (3.9)]</p><p class="math-container">\[D^{j}_{m&#39;, m}(\alpha, \beta, \gamma)
=
\left[\frac{(j+m)!(j-m)!}{(j+m&#39;)!(j-m&#39;)!}\right]^{1/2}
(\sin \frac{1}{2}\beta)^{2j}
\sum_r \binom{j+m&#39;}{r} \binom{j-m&#39;}{r-m-m&#39;}
(-1)^{j+m&#39;-r}
e^{im\alpha}
(\cot \tfrac{1}{2}\beta)^{2r-m-m&#39;}
e^{im&#39;\gamma}.\]</p><p>Equation (3.11) naturally extends to</p><p class="math-container">\[  {}_sY_{\ell, m}(\theta, \phi, \gamma)
  =
  \left[ \left(2\ell+1\right) / 4\pi \right]^{1/2}
  D^{\ell}_{-s,m}(\phi, \theta, \gamma),\]</p><p>where Eq. (3.4) also shows that <span>$D^{\ell}_{m&#39;, m}(\alpha, \beta, \gamma) = D^{\ell}_{m&#39;, m}(\alpha, \beta, 0) e^{i m&#39; \gamma}$</span>, so we have</p><p class="math-container">\[  {}_sY_{\ell, m}(\theta, \phi, \gamma)
  =
  {}_sY_{\ell, m}(\theta, \phi)\, e^{-i s \gamma}.\]</p><p>This is the most natural extension of the standard spin-weighted spherical harmonics to <span>$\mathrm{Spin}(3)$</span>.  In particular, the spin-weight operator is <span>$i \partial_\gamma$</span>, which suggests that it will be most natural to choose the sign of <span>$R_ùêÆ$</span> so that <span>$R_z = i \partial_\gamma$</span>.</p><h2 id="Griffiths-(1995)"><a class="docs-heading-anchor" href="#Griffiths-(1995)">Griffiths (1995)</a><a id="Griffiths-(1995)-1"></a><a class="docs-heading-anchor-permalink" href="#Griffiths-(1995)" title="Permalink"></a></h2><p>Griffiths&#39; <a href="../../references/#Griffiths_1995">&quot;Introduction to Quantum Mechanics&quot;</a> is probably the most common introductory text used in undergraduate physics programs, so it would be useful to compare.</p><p>Equation (4.27) gives the associated Legendre function as</p><p class="math-container">\[P_{\ell}^{m}(x)
=
(1-x^2)^{|m|/2} \left(\frac{d}{dx}\right)^{|m|} P_{\ell}(x),\]</p><p>and (4.28) gives the Legendre polynomial as</p><p class="math-container">\[P_{\ell}(x)
=
\frac{1}{2^\ell \ell!} \left(\frac{d}{dx}\right)^\ell (x^2-1)^\ell.\]</p><p>Then, (4.32) gives the spherical harmonics as</p><p class="math-container">\[Y_{\ell}^{m}(\theta, \phi)
=
\epsilon
\sqrt{\frac{2\ell+1}{4\pi} \frac{(\ell-|m|)!}{(\ell+|m|)!}}
e^{im\phi} P_{\ell}^{m}(\cos\theta),\]</p><p>where <span>$\epsilon = (-1)^m$</span> for <span>$m\geq 0$</span> and <span>$\epsilon = 1$</span> for <span>$m\leq 0$</span>.  In Table 4.2, he explicitly lists the first few spherical harmonics:</p><p class="math-container">\[\begin{aligned}
  Y_{0}^{0} &amp;= \left(\frac{1}{4\pi}\right)^{1/2},\\
  Y_{1}^{0} &amp;= \left(\frac{3}{4\pi}\right)^{1/2} \cos\theta,\\
  Y_{1}^{\pm 1} &amp;= \mp \left(\frac{3}{8\pi}\right)^{1/2} \sin\theta e^{\pm i\phi},\\
  Y_{2}^{0} &amp;= \left(\frac{5}{16\pi}\right)^{1/2} \left(3\cos^2\theta - 1\right),\\
  Y_{2}^{\pm 1} &amp;= \mp \left(\frac{15}{8\pi}\right)^{1/2} \sin\theta \cos\theta e^{\pm i\phi},\\
  Y_{2}^{\pm 2} &amp;= \left(\frac{15}{32\pi}\right)^{1/2} \sin^2\theta e^{\pm 2i\phi}.
  Y_{3}^{0} &amp;= \left(\frac{7}{16\pi}\right)^{1/2} \left(5\cos^3\theta - 3\cos\theta\right),\\
  Y_{3}^{\pm 1} &amp;= \mp \left(\frac{21}{64\pi}\right)^{1/2} \sin\theta \left(5\cos^2\theta - 1\right) e^{\pm i\phi},\\
  Y_{3}^{\pm 2} &amp;= \left(\frac{105}{32\pi}\right)^{1/2} \sin^2\theta \cos\theta e^{\pm 2i\phi},\\
  Y_{3}^{\pm 3} &amp;= \mp \left(\frac{35}{64\pi}\right)^{1/2} \sin^3\theta e^{\pm 3i\phi}.
\end{aligned}\]</p><p>In Eqs. (4.127)‚Äî(4.129), he gives the angular-momentum operators in terms of spherical coordinates:</p><p class="math-container">\[\begin{aligned}
L_x &amp;= \frac{\hbar}{i} \left(
    -\sin\phi \frac{\partial} {\partial \theta}
    - \cos\phi \cot\theta \frac{\partial} {\partial \phi}
\right), \\
L_y &amp;= \frac{\hbar}{i} \left(
    \cos\phi \frac{\partial} {\partial \theta}
    - \sin\phi \cot\theta \frac{\partial} {\partial \phi}
\right), \\
L_z &amp;= -i \hbar \frac{\partial} {\partial \phi}.
\end{aligned}\]</p><h2 id="LALSuite"><a class="docs-heading-anchor" href="#LALSuite">LALSuite</a><a id="LALSuite-1"></a><a class="docs-heading-anchor-permalink" href="#LALSuite" title="Permalink"></a></h2><p><a href="../../references/#LALSuite_2018">LALSuite (LSC Algorithm Library Suite)</a> is a collection of software routines, comprising the primary official software used by the LIGO-Virgo-KAGRA Collaboration to detect and characterize gravitational waves.  As far as I can tell, the ultimate source for all spin-weighted spherical harmonic values used in LALSuite is the function <a href="https://git.ligo.org/lscsoft/lalsuite/-/blob/6e653c91b6e8a6728c4475729c4f967c9e09f020/lal/lib/utilities/SphericalHarmonics.c"><code>XLALSpinWeightedSphericalHarmonic</code></a>, which cites the NINJA paper <a href="../../references/#Ajith_2007">Ajith <em>et al.</em> [24]</a> as its source. Unfortunately, it cites version <em>1</em>, which contained a serious error, using <span>$\tfrac{\cos\iota}{2}$</span> instead of <span>$\cos \tfrac{\iota}{2}$</span> and similarly for <span>$\sin$</span>.  This error was corrected in version 2, but the citation was not updated.  Nonetheless, it appears that the actual code is consistent with the corrected versions of the NINJA paper; the equivalence is <a href="https://github.com/moble/SphericalFunctions.jl/blob/0f57c77e65da85e4996f0969fe0a931b460135ac/test/wigner_matrices/sYlm.jl#L59">tested</a> in this package&#39;s test suite.</p><h2 id="Le-Bellac-(2006)"><a class="docs-heading-anchor" href="#Le-Bellac-(2006)">Le Bellac (2006)</a><a id="Le-Bellac-(2006)-1"></a><a class="docs-heading-anchor-permalink" href="#Le-Bellac-(2006)" title="Permalink"></a></h2><p><a href="../../references/#LeBellac_2006">Le Bellac [25]</a> (with Foreword by Cohen-Tannoudji) takes an odd approach, defining [Eq. (10.32)]</p><p class="math-container">\[D^{(j)}_{m&#39;, m} \left[ \mathcal{R}(\theta, \phi) \right]
=
\langle j, m&#39; | e^{-i\phi J_z} e^{-i\theta J_y} | j, m \rangle,\]</p><p>but later allowing that <span>$e^{-i \psi J_z}$</span> usually goes on the right-hand side of the others, in which case <span>$D^{(j)}(\theta, \phi) \to D^{(j)}(\phi, \theta, \psi)$</span>.  Figure 10.1 shows that the spherical coordinates are standard (physicist&#39;s) coordinates.</p><p>Equation (10.65) shows the rotation law:</p><p class="math-container">\[Y_{\ell}^{m}\left( \mathcal{R}^{-1} \hat{r} \right)
=
\sum_{m&#39;} D^{(\ell)}_{m&#39;, m}(\mathcal{R}) Y_{\ell}^{m&#39;}(\hat{r}),\]</p><p>and Eq. (10.66) relates the spherical harmonics to the Wigner D-matrices:</p><p class="math-container">\[D^{(\ell)}_{m, 0}(\theta, \phi)
=
\sqrt{\frac{4\pi}{2\ell+1}} \left[Y_{\ell}^{m}(\theta, \phi)\right]^\ast.\]</p><h2 id="Mathematica"><a class="docs-heading-anchor" href="#Mathematica">Mathematica</a><a id="Mathematica-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematica" title="Permalink"></a></h2><p>The Euler angles are defined generally such that</p><blockquote><p><code>EulerMatrix[{Œ±,Œ≤,Œ≥},{a,b,c}]</code> is equivalent to <span>$R_{Œ±,a} R_{Œ≤,b} R_{Œ≥,c}$</span>, where <span>$R_{Œ±,a}$</span>=<code>RotationMatrix[Œ±,UnitVector[3,a]]</code>, etc.</p></blockquote><p>and</p><blockquote><p><code>EulerMatrix[{Œ±,Œ≤,Œ≥}]</code> is equivalent to <code>EulerMatrix[{Œ±,Œ≤,Œ≥},{3,2,3}]</code></p></blockquote><p>(representing the <span>$z-y-z$</span> convention).</p><p>Finally, we find that they say that <code>EulerMatrix</code>` corresponds to three rotations:</p><pre><code class="language-mathematica hljs">rŒ± = RotationMatrix[Œ±, {0, 0, 1}];
rŒ≤ = RotationMatrix[Œ≤, {0, 1, 0}];
rŒ≥ = RotationMatrix[Œ≥, {0, 0, 1}];

Simplify[rŒ± . rŒ≤ . rŒ≥ == EulerMatrix[{Œ±, Œ≤, Œ≥}]]</code></pre><p>This agrees with the conventions used in this package, so we can directly compare expressions in terms of Euler angles.</p><p>We can find conventions at <a href="https://reference.wolfram.com/language/ref/WignerD.html">this page</a>.</p><blockquote><p>The Wolfram Language uses phase conventions where <span>$D^j_{m_1, m_2}(\psi, \theta, \phi) = \exp(i m_1 \psi + i m_2 \phi) D^j_{m_1, m_2}(0, \theta, 0)$</span>.</p></blockquote><blockquote><p><code>WignerD[{1, 0, 1}, œà, Œ∏, œï]</code> = <span>$-\sqrt{2} e^{i \phi} \cos\frac{\theta}{2} \sin\frac{\theta}{2}$</span></p></blockquote><blockquote><p><code>WignerD[{ùìÅ, 0, m}, Œ∏, œï] == Sqrt[(4 œÄ)/(2 ùìÅ + 1)] SphericalHarmonicY[ùìÅ, m, Œ∏, œï]</code></p></blockquote><blockquote><p><code>WignerD[{j, m1, m2},œà, Œ∏, œï] == (-1)^(m1 - m2) Conjugate[WignerD[{j, -m1, -m2}, œà, Œ∏, œï]]</code></p></blockquote><blockquote><p>For <span>$\ell \geq 0$</span>, <span>$Y_\ell^m = \sqrt{(2\ell+1)/(4\pi)} \sqrt{(\ell-m)! / (\ell+m)!}  P_\ell^m(\cos \theta) e^{im\phi}$</span> where <span>$P_\ell^m$</span> is the associated Legendre function.</p></blockquote><blockquote><p>The associated Legendre polynomials are defined by <span>$P_n^m(x) = (-1)^m (1-x^2)^{m/2}(d^m/dx^m)P_n(x)$</span> where <span>$P_n(x)$</span> is the Legendre polynomial.</p></blockquote><p><a href="https://dlmf.nist.gov/14.7#E13">NIST (14.7.13)</a> gives the Legendre polynomial for nonnegative integer <span>$n$</span> as</p><p class="math-container">\[P_n(x) = \frac{1}{2^n n!} \frac{d^n}{dx^n} (x^2 - 1)^n.\]</p><h2 id="Newman-Penrose"><a class="docs-heading-anchor" href="#Newman-Penrose">Newman-Penrose</a><a id="Newman-Penrose-1"></a><a class="docs-heading-anchor-permalink" href="#Newman-Penrose" title="Permalink"></a></h2><p>In their 1966 paper, <a href="../../references/#Newman_1966">Newman and Penrose [7]</a>, Newman and Penrose first introduced the spin-weighted spherical harmonics, <span>${}_sY_{\ell m}$</span>. They use the standard (physicists&#39;) convention for spherical coordinates and introduce the stereographic coordinate <span>$\zeta = e^{i\phi} \cot\frac{\theta}{2}$</span>.  They define the spin-raising operator <span>$\eth$</span> acting on a function of spin weight <span>$s$</span> as</p><p class="math-container">\[\eth \eta
=
-\left(\sin\theta\right)^s
\left\{
    \frac{\partial}{\partial\theta}
    + \frac{i}{\sin\theta} \frac{\partial}{\partial\phi}
\right\} \left\{\left(\sin\theta\right)^{-s} \eta\right\},\]</p><p>They then compute</p><p class="math-container">\[{}_sY_{\ell, m}
\propto
\frac{1}{\left[(\ell-s)! (\ell+s)!\right]^{1/2}}
\left(1 + \zeta \bar{\zeta}\right)^{-\ell}
\sum_p \zeta^p (-\bar{\zeta})^{p+s-m}
\binom{\ell-s}{p} \binom{\ell+s}{p+s-m},\]</p><p>where the sum is over all integers <span>$p$</span> such that the factorials are nonzero.</p><p>They are a little ambiguous about the relationship of the complex basis vector <span>$m^\mu$</span> to the coordinates.  </p><blockquote><p>The vectors <span>$\Re(m^\mu)$</span> and <span>$\Im(m^\mu)$</span> may be regarded as orthogonal tangent vectors (of length <span>$2^{-1/2}$</span>) at each point of the surface. [...] If spherical polar coordinates are used, a natural choice for <span>$m^\mu$</span> is to make <span>$\Re(m^\mu)$</span> and <span>$\Im(m^\mu)$</span> tangential, respectively, to the curves <span>$\phi = \mathrm{const}$</span> and <span>$\theta = \mathrm{const}.$</span></p></blockquote><p>The ambiguity is in the sign implied by &quot;tangential&quot;, but the natural choice is to assume they mean that the components are <em>positive</em> multiples of <span>$\partial_\theta$</span> and <span>$\partial_\phi$</span> respectively, in which case we have</p><p class="math-container">\[m^\mu = \frac{1}{\sqrt{2}}
\left[ \partial_\theta + i \csc\theta \partial_\phi \right].\]</p><p>They define the spin weight in terms of behavior of a quantity under rotation of <span>$m^\mu$</span> in its own plane as</p><p class="math-container">\[(m^\mu)&#39;
=
e^{i\psi} m^\mu
=
\frac{1}{\sqrt{2}}
\left[ 
  \left(\cos\psi\partial_\theta - \sin\psi\csc\theta \partial_\phi\right)
  + i \left(\cos\psi\csc\theta \partial_\phi + \sin\psi\partial_\theta\right)
\right].\]</p><p>Raising the spherical coordinates <span>$(\theta, \phi)$</span> to Euler angles <span>$(\phi, \theta, -\psi)$</span>, we see that the rotor <span>$R_{\phi, \theta, -\psi}$</span> rotates the <span>$ùê≥$</span> basis vector to the point <span>$(\theta, \phi)$</span>, and it rotates <span>$(ùê± + i ùê≤) / \sqrt{2}$</span> onto <span>$(m^\mu)&#39;$</span>. Under this rotation, a quantity <span>$\eta$</span> has spin weight <span>$s$</span> if it transforms as</p><p class="math-container">\[\eta&#39; = e^{i s \psi} \eta.\]</p><p>Now, supposing that these quantities are functions of Euler angles, we can write</p><p class="math-container">\[\eta(\phi, \theta, -\psi) = e^{i s \psi} \eta(\phi, \theta, 0),\]</p><p>or</p><p class="math-container">\[\eta(\phi, \theta, \gamma) = e^{-i s \gamma} \eta(\phi, \theta, 0).\]</p><p>Thus, the operator with eigenvalue <span>$s$</span> is <span>$i \partial_\gamma$</span>.</p><h2 id="NINJA"><a class="docs-heading-anchor" href="#NINJA">NINJA</a><a id="NINJA-1"></a><a class="docs-heading-anchor-permalink" href="#NINJA" title="Permalink"></a></h2><p><a href="../../references/#Ajith_2007">Ajith <em>et al.</em> [24]</a> was prepared by a broad cross-section of researchers (including the author of this package) involved in modeling gravitational waves with the intent of providing a shared set of conventions.  The spherical coordinates are standard physicist&#39;s coordinates, except that the polar angle is denoted <span>$\iota$</span>. Equation (II.7) is</p><p class="math-container">\[  {}^{-s}Y_{l,m} = (-1)^s\sqrt{\frac{2\ell+1}{4\pi}}
  d^{\ell}_{m,s}(\iota)e^{im\phi},\]</p><p>where</p><p class="math-container">\[  d^{\ell}_{m,s}(\iota)
  =
  \sum_{k = k_1}^{k_2}
  \frac{(-1)^k[(\ell+m)!(\ell-m)!(\ell+s)!(\ell-s)!]^{1/2}}
  {(\ell+m-k)!(\ell-s-k)!k!(k+s-m)!}
  \left(\cos\left(\frac{\iota}{2}\right)\right)^{2\ell+m-s-2k}
  \left(\sin\left(\frac{\iota}{2}\right)\right)^{2k+s-m}\]</p><p>with <span>$k_1 = \textrm{max}(0, m-s)$</span> and <span>$k_2=\textrm{min}(\ell+m, \ell-s)$</span>. For reference, they provide several values [Eqs. (II.9)‚Äì(II.13)]:</p><p class="math-container">\[\begin{aligned}
  {}^{-2}Y_{2,2} &amp;= \sqrt{\frac{5}{64\pi}}(1+\cos\iota)^2e^{2i\phi},\\
  {}^{-2}Y_{2,1} &amp;= \sqrt{\frac{5}{16\pi}}  \sin\iota( 1 + \cos\iota )e^{i\phi},\\
  {}^{-2}Y_{2,0} &amp;= \sqrt{\frac{15}{32\pi}} \sin^2\iota,\\
  {}^{-2}Y_{2,-1} &amp;= \sqrt{\frac{5}{16\pi}}  \sin\iota( 1 - \cos\iota
  )e^{-i\phi},\\
  {}^{-2}Y_{2,-2} &amp;=&amp; \sqrt{\frac{5}{64\pi}}(1-\cos\iota)^2e^{-2i\phi}.
\end{aligned}\]</p><p>Note that most of the above was copied directly from the TeX source of the paper.  Also note the annoying negative sign on the left-hand side of the first expression.  Getting rid of it and combining the first two expressions, we have the full formula for the spin-weighted spherical harmonics in this convention:</p><p class="math-container">\[\begin{aligned}
  {}_{s}Y_{lm}
  &amp;=
  (-1)^s\sqrt{\frac{2\ell+1}{4\pi}} e^{im\phi}
  \sum_{k = k_1}^{k_2}
  \frac{(-1)^k[(\ell+m)!(\ell-m)!(\ell-s)!(\ell+s)!]^{1/2}}
  {(\ell+m-k)!(\ell+s-k)!k!(k-s-m)!}
  \\ &amp;\qquad \times
  \left(\cos\left(\frac{\iota}{2}\right)\right)^{2\ell+m+s-2k}
  \left(\sin\left(\frac{\iota}{2}\right)\right)^{2k-s-m}
\end{aligned}\]</p><p>where <span>$k_1 = \textrm{max}(0, m+s)$</span> and <span>$k_2=\textrm{min}(\ell+m, \ell+s)$</span>.</p><h2 id="Sakurai-(1994)"><a class="docs-heading-anchor" href="#Sakurai-(1994)">Sakurai (1994)</a><a id="Sakurai-(1994)-1"></a><a class="docs-heading-anchor-permalink" href="#Sakurai-(1994)" title="Permalink"></a></h2><h2 id="Scipy"><a class="docs-heading-anchor" href="#Scipy">Scipy</a><a id="Scipy-1"></a><a class="docs-heading-anchor-permalink" href="#Scipy" title="Permalink"></a></h2><p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.sph_harm_y.html"><code>scipy.special.sph_harm_y</code></a></p><h2 id="Shankar-(1994)"><a class="docs-heading-anchor" href="#Shankar-(1994)">Shankar (1994)</a><a id="Shankar-(1994)-1"></a><a class="docs-heading-anchor-permalink" href="#Shankar-(1994)" title="Permalink"></a></h2><p><a href="../../references/#Shankar_1994">Shankar [26]</a> writes in Eq. (12.5.35) the spherical harmonics as</p><p class="math-container">\[Y_{\ell}^{m}(\theta, \phi)
=
(-1)^\ell
\left[ \frac{(2\ell+1)!}{4\pi} \right]^{1/2}
\frac{1}{2^\ell \ell!}
\left[ \frac{(\ell+m)!}{(2\ell)!(\ell-m)!} \right]^{1/2}
e^{i m \phi}
(\sin \theta)^{-m}
\frac{d^{\ell-m}}{d(\cos\theta)^{\ell-m}}
(\sin\theta)^{2\ell}\]</p><p>for <span>$m \geq 0$</span>, with (12.5.40) giving the expression</p><p class="math-container">\[Y_{\ell}^{-m}(\theta, \phi)
=
(-1)^m \left( Y_{\ell}^{m}(\theta, \phi) \right)^\ast.\]</p><p>The angular-momentum operators are given below (12.5.27) as</p><p class="math-container">\[\begin{aligned}
L_x &amp;= i \hbar \left(
    \sin\phi \frac{\partial} {\partial \theta}
    + \cos\phi \cot\theta \frac{\partial} {\partial \phi}
\right),
\\
L_y &amp;= i \hbar \left(
    -\cos\phi \frac{\partial} {\partial \theta}
    + \sin\phi \cot\theta \frac{\partial} {\partial \phi}
\right),
\\
L_z &amp;= -i \hbar \frac{\partial} {\partial \phi}.
\end{aligned}\]</p><p>In Exercise 12.5.7, the rotation operator is defined by</p><p class="math-container">\[U\left[ R(\alpha, \beta, \gamma) \right]
=
e^{-i \alpha J_z/\hbar}
e^{-i \beta J_y/\hbar}
e^{-i \gamma J_z/\hbar},\]</p><p>That <span>$U$</span> becomes a <span>$D^{(j)}$</span> when the operator is acting on the states <span>$|j, m\rangle$</span> for a given <span>$j$</span>.  Thus, while Shankar never actually uses notation like <span>$D^{(j)}_{m&#39;, m}$</span>, he does talk about <span>$\langle j, m&#39; | D^{(j)}\left[ R(\alpha, \beta, \gamma) \right] | j, m \rangle$</span>.</p><h2 id="SymPy"><a class="docs-heading-anchor" href="#SymPy">SymPy</a><a id="SymPy-1"></a><a class="docs-heading-anchor-permalink" href="#SymPy" title="Permalink"></a></h2><p>There is no specific Euler angle convention in SymPy, however it is informative to see what the <code>sympy.algebras.Quaternion.from_euler</code> class method does.  You can specify </p><p>SymPy uses what I would consider just a wrong expression for <span>$D$</span>. Specifically, the <a href="https://github.com/sympy/sympy/blob/b4ce69ad5d40e4e545614b6c76ca9b0be0b98f0b/sympy/physics/wigner.py#L1136-L1191">source</a> cites <a href="../../references/#Edmonds_2016">Edmonds [20]</a> when defining</p><p class="math-container">\[\mathcal{D}_{\alpha \beta \gamma} =
\exp\big( \frac{i\alpha}{\hbar} J_z\big)
\exp\big( \frac{i\beta}{\hbar} J_y\big)
\exp\big( \frac{i\gamma}{\hbar} J_z\big).\]</p><p>But that is an incorrect copy of Edmonds&#39; Eq. (4.1.9), in which the <span>$\alpha$</span> and <span>$\gamma$</span> on the right-hand side are swapped.  The code also implements D in the <code>wigner_d</code> function as (essentially)</p><pre><code class="language-python hljs">exp(I*mprime*alpha)*d[i, j]*exp(I*m*gamma)</code></pre><p>even though the actual equation Eq. (4.1.12) says</p><p class="math-container">\[\mathscr{D}^{(j)}_{m&#39; m}(\alpha \beta \gamma) =
\exp i m&#39; \gamma d^{(j)}_{m&#39; m}(\alpha, \beta) \exp(i m \alpha).\]</p><p>The <span>$d$</span> matrix appears to be implemented consistently with Edmonds, and thus not affected.</p><p>Basically, it appears that SymPy just swapped the order of the Euler angles relative to Edmonds, who already introduced a conjugate to the definition of the D matrix.</p><h2 id="Thorne"><a class="docs-heading-anchor" href="#Thorne">Thorne</a><a id="Thorne-1"></a><a class="docs-heading-anchor-permalink" href="#Thorne" title="Permalink"></a></h2><h2 id="Torres-del-Castillo-(2003)"><a class="docs-heading-anchor" href="#Torres-del-Castillo-(2003)">Torres del Castillo (2003)</a><a id="Torres-del-Castillo-(2003)-1"></a><a class="docs-heading-anchor-permalink" href="#Torres-del-Castillo-(2003)" title="Permalink"></a></h2><p><a href="../../references/#TorresDelCastillo_2003">Torres Del Castillo [27]</a> starts by defining a rotation <span>$\mathcal{R}$</span> as transforming a point <span>$x_i$</span> into another point with coordinates <span>$x_i&#39; = a_{ij}x_j$</span>.  Under that rotation, any scalar function <span>$f$</span> transforms into another function <span>$f&#39; = \mathcal{R} f$</span> defined by [Eq. (2.43)]</p><p class="math-container">\[f&#39;\big(x_i\big) = f\big( a^{-1}_{ij} x_j \big).\]</p><p>In particular, <span>$f&#39;(x&#39;_i) = f(x_i)$</span>.  He then defines Wigner&#39;s D-matrix to satisfy [Eq. (2.45)]</p><p class="math-container">\[\mathcal{R} Y_{l,m} = \sum_{m} D^l_{m&#39;,m}(\mathcal{R}) Y_{l,m&#39;}.\]</p><p>Including the arguments to the spherical harmonics, this becomes</p><p class="math-container">\[Y_{l,m}\big(\mathcal{R}^{-1} R_{\theta, \phi}\big)
=
\sum_{m} D^l_{m&#39;,m}(\mathcal{R}) Y_{l,m&#39;}\big(R_{\theta, \phi}\big).\]</p><p>In this form, we have [Eq. (2.46)]</p><p class="math-container">\[D^l_{m&#39;&#39;,m}(\mathcal{R}_1 \mathcal{R}_2)
=
\sum_{m&#39;} D^l_{m&#39;&#39;,m&#39;}(\mathcal{R}_1) D^l_{m&#39;,m}(\mathcal{R}_2).\]</p><p>He computes [Eq. (2.53)]</p><p class="math-container">\[D^l_{m&#39;,m}(\phi, \theta, \chi)
=
e^{-i m&#39; \phi} d^l_{m&#39;,m}(\theta) e^{-i m \chi},\]</p><p>where the <span>$d$</span> matrix is given by</p><p class="math-container">\[d^l_{m&#39;,m}(\theta)
=
\sqrt{(l+m)!(l-m)!(l+m&#39;)!(l-m&#39;)!}
\sum_{k} \frac{
  (-1)^k
  (\sin \tfrac{1}{2} \theta)^{m-m&#39;+2k}
  (\cos \tfrac{1}{2} \theta)^{2l-m+m&#39;-2k}
} {
  k!(l+m&#39;-k)!(l-m-k)!(m-m&#39;+k)!
},\]</p><p>and the spin-weighted spherical harmonic is related to <span>$D$</span> by</p><p class="math-container">\[{}_{s}Y_{j,m}(\theta, \phi)
=
(-1)^m
\sqrt{\frac{2j+1}{4\pi}}
d^j_{-m,s}(\theta)
e^{i m \phi}.\]</p><h2 id="Varshalovich-et-al.-(1988)"><a class="docs-heading-anchor" href="#Varshalovich-et-al.-(1988)">Varshalovich et al. (1988)</a><a id="Varshalovich-et-al.-(1988)-1"></a><a class="docs-heading-anchor-permalink" href="#Varshalovich-et-al.-(1988)" title="Permalink"></a></h2><p><a href="../../references/#Varshalovich_1988">Varshalovich <em>et al.</em> [28]</a> has a fairly decent comparison of definitions related to the rotation matrix by previous authors.  </p><p>Eq. 1.4.(31) defines the operator</p><p class="math-container">\[\hat{D}(\alpha, \beta, \gamma)
=
e^{-i\alpha \hat{J}_z}
e^{-i\beta \hat{J}_y}
e^{-i\gamma \hat{J}_z},\]</p><p>where the <span>$\hat{J}$</span> operators are defined in </p><blockquote><p>In quantum mechanics the total angular momentum operator <span>$\hat{J}$</span> is defined as an operator which generates transformations of wave functions (state vectors) and quantum operators under infinitesimal rotations of the coordinate system (see Eqs. 2.1.(1) and 2.1.(2)).</p><p>A transformation of an arbitrary wave function <span>$\Psi$</span> under rotation of the coordinate system through an infinitesimal angle <span>$\delta \omega$</span> about an axis <span>$\mathbf{n}$</span> may be written as</p><p class="math-container">\[\Psi \to \Psi&#39; = \left(1 - i \delta \omega \mathbf{n} \cdot \hat{J} \right)\Psi,\]</p><p>where <span>$\hat{J}$</span> is the total angular momentum operator.</p></blockquote><p>Eq. 4.1.(1) defines the Wigner D-functions according to</p><p class="math-container">\[\langle J M | \hat{D}(\alpha, \beta, \gamma) | J&#39; M&#39; \rangle
=
\delta_{J J&#39;} D^J_{M M&#39;}(\alpha, \beta, \gamma).\]</p><p>Eq. 4.3.(1) states</p><p class="math-container">\[D^J_{M M&#39;}(\alpha, \beta, \gamma)
=
e^{-i M \alpha}
d^J_{M M&#39;}(\beta)
e^{-i M&#39; \gamma}\]</p><p>Page 155 has a table of values for <span>$\ell \leq 5$</span></p><p><a href="../../references/#Varshalovich_1988">Varshalovich <em>et al.</em> [28]</a> distinguish in Sec. 1.1.3 between <em>covariant</em> and <em>contravariant</em> spherical coordinates and the corresponding basis vectors, which they define as</p><p class="math-container">\[\begin{aligned}
  \mathbf{e}_{+1} &amp;= - \frac{1}{\sqrt{2}} \left( \mathbf{e}_x + i \mathbf{e}_y\right)
  &amp;&amp;&amp;
  \mathbf{e}^{+1} &amp;= - \frac{1}{\sqrt{2}} \left( \mathbf{e}_x - i \mathbf{e}_y\right) \\
  \mathbf{e}_{0} &amp;= \mathbf{e}_z &amp;&amp;&amp; \mathbf{e}^{0} &amp;= \mathbf{e}_z \\
  \mathbf{e}_{-1} &amp;= \frac{1}{\sqrt{2}} \left( \mathbf{e}_x - i \mathbf{e}_y\right)
  &amp;&amp;&amp;
  \mathbf{e}^{-1} &amp;= \frac{1}{\sqrt{2}} \left( \mathbf{e}_x + i \mathbf{e}_y\right).
\end{aligned}\]</p><p>Then, in Sec. 4.2 they define <span>$\hat{\mathbf{J}}$</span> as the operator of angular momentum of the rigid symmetric top.  They then give in Eq. (6) the &quot;covariant spherical coordinates of <span>$\hat{\mathbf{J}}$</span> in the non-rotating (lab-fixed) system&quot; as</p><p class="math-container">\[\begin{gather}
  \hat{J}_{\pm 1} = \frac{i}{\sqrt{2}} e^{\pm i \alpha} \left[
    \mp \cot\beta \frac{\partial}{\partial \alpha}
    + i \frac{\partial}{\partial \beta}
    \pm \frac{1}{\sin\beta} \frac{\partial}{\partial \gamma}
  \right] \\
  \hat{J}_0 = - i \frac{\partial}{\partial \alpha},
\end{gather}\]</p><p>and &quot;contravariant components of <span>$\hat{\mathbf{J}}$</span> in the rotating (body-fixed) system&quot; as</p><p class="math-container">\[\begin{gather}
  \hat{J}&#39;^{\pm 1} = \frac{i}{\sqrt{2}} e^{\mp i \gamma} \left[
    \pm \cot\beta \frac{\partial}{\partial \gamma}
    + i \frac{\partial}{\partial \beta}
    \mp \frac{1}{\sin\beta} \frac{\partial}{\partial \alpha}
  \right] \\
  \hat{J}&#39;^0 = - i \frac{\partial}{\partial \gamma}.
\end{gather}\]</p><p>(Note the prime in the last two equations.)  We can expand these in Cartesian components to compare to our expressions.  First the covariant components:</p><p class="math-container">\[\begin{aligned}
  \hat{J}_{x}
  &amp;= -\frac{1}{\sqrt{2}} \left( \hat{J}_{+1} - \hat{J}_{-1} \right) \\
  % &amp;= -\frac{1}{\sqrt{2}} \left( 
  %   \frac{i}{\sqrt{2}} e^{i \alpha} \left[
  %     - \cot\beta \frac{\partial}{\partial \alpha}
  %     + i \frac{\partial}{\partial \beta}
  %     + \frac{1}{\sin\beta} \frac{\partial}{\partial \gamma}
  %   \right]
  %   -
  %   \frac{i}{\sqrt{2}} e^{-i \alpha} \left[
  %     + \cot\beta \frac{\partial}{\partial \alpha}
  %     + i \frac{\partial}{\partial \beta}
  %     - \frac{1}{\sin\beta} \frac{\partial}{\partial \gamma}
  %   \right]
  % \right) \\
  &amp;= i\left[ 
      \frac{\cos\alpha}{\tan\beta} \frac{\partial}{\partial \alpha}
      + \sin\alpha \frac{\partial}{\partial \beta}
      - \frac{\cos\alpha}{\sin\beta} \frac{\partial}{\partial \gamma}
  \right] \\
  \hat{J}_{y}
  &amp;= -\frac{1}{i\sqrt{2}} \left( \hat{J}_{+1} + \hat{J}_{-1} \right) \\
  % &amp;= -\frac{1}{i\sqrt{2}} \left( 
  %   \frac{i}{\sqrt{2}} e^{i \alpha} \left[
  %     - \cot\beta \frac{\partial}{\partial \alpha}
  %     + i \frac{\partial}{\partial \beta}
  %     + \frac{1}{\sin\beta} \frac{\partial}{\partial \gamma}
  %   \right]
  %   +
  %   \frac{i}{\sqrt{2}} e^{-i \alpha} \left[
  %     + \cot\beta \frac{\partial}{\partial \alpha}
  %     + i \frac{\partial}{\partial \beta}
  %     - \frac{1}{\sin\beta} \frac{\partial}{\partial \gamma}
  %   \right]
  % \right) \\
  &amp;= i \left[
      \frac{\sin\alpha}{\tan\beta} \frac{\partial}{\partial \alpha}
      - \cos\alpha \frac{\partial}{\partial \beta}
      - \frac{\sin\alpha}{\sin\beta} \frac{\partial}{\partial \gamma}
  \right] \\
  \hat{J}_{z}
  &amp;= \hat{J}_{0} \\
  &amp;= -i \frac{\partial}{\partial \alpha}
\end{aligned}\]</p><p>We can compare these to the <a href="../../literate_output/euler_angular_momentum/#Full-expressions-on-S3">Full expressions on <span>$S^3$</span></a>, and find that they are precisely equivalent to expressions for <span>$L_j$</span> computed in this package&#39;s conventions.</p><p>Next, the contravariant components:</p><p class="math-container">\[\begin{aligned}
  \hat{J}&#39;_{x}
  &amp;= -\frac{1}{\sqrt{2}} \left( \hat{J}&#39;^{+1} - \hat{J}&#39;^{-1} \right) \\
  % &amp;= -\frac{1}{\sqrt{2}} \left(
  %   \frac{i}{\sqrt{2}} e^{- i \gamma} \left[
  %     + \cot\beta \frac{\partial}{\partial \gamma}
  %     + i \frac{\partial}{\partial \beta}
  %     - \frac{1}{\sin\beta} \frac{\partial}{\partial \alpha}
  %   \right]
  %   -
  %   \frac{i}{\sqrt{2}} e^{+ i \gamma} \left[
  %     - \cot\beta \frac{\partial}{\partial \gamma}
  %     + i \frac{\partial}{\partial \beta}
  %     + \frac{1}{\sin\beta} \frac{\partial}{\partial \alpha}
  %   \right]
  % \right) \\
  &amp;= -i \left(
      \frac{\cos\gamma}{\tan\beta} \frac{\partial}{\partial \gamma}
      + \sin\gamma \frac{\partial}{\partial \beta}
      - \frac{\cos\gamma}{\sin\beta} \frac{\partial}{\partial \alpha}
  \right) \\
  \hat{J}&#39;_{y}
  &amp;= \frac{1}{i\sqrt{2}} \left( \hat{J}&#39;^{+1} + \hat{J}&#39;^{-1} \right) \\
  % &amp;= \frac{1}{i\sqrt{2}} \left(
  %   \frac{i}{\sqrt{2}} e^{-i \gamma} \left[
  %     + \cot\beta \frac{\partial}{\partial \gamma}  
  %     + i \frac{\partial}{\partial \beta}
  %     - \frac{1}{\sin\beta} \frac{\partial}{\partial \alpha}
  %   \right]
  %   +
  %   \frac{i}{\sqrt{2}} e^{+ i \gamma} \left[
  %     - \cot\beta \frac{\partial}{\partial \gamma}
  %     + i \frac{\partial}{\partial \beta}
  %     + \frac{1}{\sin\beta} \frac{\partial}{\partial \alpha}
  %   \right]
  % \right) \\
  &amp;= -i \left(
      \frac{\sin\gamma}{\tan\beta} \frac{\partial}{\partial \gamma}
      - \cos\gamma \frac{\partial}{\partial \beta}
      - \frac{\sin\gamma}{\sin\beta} \frac{\partial}{\partial \alpha}
  \right) \\
  \hat{J}&#39;_{z}
  &amp;= \hat{J}&#39;^{0} \\
  &amp;= -i \frac{\partial}{\partial \gamma}
\end{aligned}\]</p><p>Unfortunately, while we have agreement on <span>$\hat{J}&#39;^{y} = R_y$</span>, we also have disagreement on <span>$\hat{J}&#39;^{x} = -R_x$</span> and <span>$\hat{J}&#39;^{z} = -R_z$</span>, as they have relative minus signs.</p><p>It&#39;s very easy to check, for example, that <span>$[\hat{J}&#39;^{z}, \hat{J}&#39;^{x}] = i \hat{J}&#39;^{y}$</span>, as expected from the general expression in their Eq. (12).  So these expressions are ‚Äî at least ‚Äî consistent with the claims of Varshalovich et al.  I wonder if there is some subtlety involving the order of operations and passing to the &quot;body-fixed&quot; frame.  I&#39;m confident that my definitions are internally consistent, and fit in nicely with the spin-weighted function literature; maybe Varshalovich et al. are just doing something different.</p><h2 id="Wikipedia"><a class="docs-heading-anchor" href="#Wikipedia">Wikipedia</a><a id="Wikipedia-1"></a><a class="docs-heading-anchor-permalink" href="#Wikipedia" title="Permalink"></a></h2><p>Defining the operator</p><p class="math-container">\[\mathcal{R}(\alpha,\beta,\gamma) = e^{-i\alpha J_z}e^{-i\beta J_y}e^{-i\gamma J_z},\]</p><p><a href="https://en.wikipedia.org/wiki/Wigner_D-matrix#Definition_of_the_Wigner_D-matrix">Wikipedia defines the Wigner D-matrix</a> as</p><p class="math-container">\[D^j_{m&#39;m}(\alpha,\beta,\gamma) \equiv \langle jm&#39; | \mathcal{R}(\alpha,\beta,\gamma)| jm \rangle =e^{-im&#39;\alpha } d^j_{m&#39;m}(\beta)e^{-i m\gamma}.\]</p><h2 id="Wigner"><a class="docs-heading-anchor" href="#Wigner">Wigner</a><a id="Wigner-1"></a><a class="docs-heading-anchor-permalink" href="#Wigner" title="Permalink"></a></h2><h2 id="Zettili-(2009)"><a class="docs-heading-anchor" href="#Zettili-(2009)">Zettili (2009)</a><a id="Zettili-(2009)-1"></a><a class="docs-heading-anchor-permalink" href="#Zettili-(2009)" title="Permalink"></a></h2><p><a href="../../references/#Zettili_2009">Zettili [29]</a> denotes by <span>$\hat{R}_z(\delta \phi)$</span> the</p><blockquote><p>rotation of the coordinates of a <em>spinless</em> particle over an <em>infinitesimal</em> angle <span>$\delta \phi$</span> about the <span>$z$</span>-axis</p></blockquote><p>and shows its action [Eq. (7.16)]</p><p class="math-container">\[\hat{R}_z (\delta \phi) \psi(r, \theta, \phi)
=
\psi(r, \theta, \phi - \delta \phi).\]</p><blockquote><p>We may generalize this relation to a rotation of angle <span>$\delta \phi$</span> about an arbitrary axis whose direction is given by the unit vector <span>$\vec{n}$</span>:</p></blockquote><p class="math-container">\[\hat{R}(\delta \phi)
=
1 - \frac{i}{\hbar} \delta \phi \vec{n} \cdot \hat{\vec{L}}.\]</p><p>This extends to finite rotation by defining the operator [Eq. (7.48)]</p><p class="math-container">\[\hat{R}(\alpha, \beta, \gamma)
=
e^{-i\alpha J_z / \hbar} e^{-i\beta J_y / \hbar} e^{-i\gamma J_z / \hbar}.\]</p><p>Equation (7.52) then defines</p><p class="math-container">\[D^{(j)}_{m&#39;, m}(\alpha, \beta, \gamma)
=
\langle j, m&#39; | \hat{R}(\alpha, \beta, \gamma) | j, m \rangle,\]</p><p>So that [Eq. (7.54)]</p><p class="math-container">\[D^{(j)}_{m&#39;, m}(\alpha, \beta, \gamma)
=
e^{-i (m&#39; \alpha + m \gamma)} d^{(j)}_{m&#39;, m}(\beta),\]</p><p>where [Eq. (7.55)]</p><p class="math-container">\[d^{(j)}_{m&#39;, m}(\beta)
=
\langle j, m&#39; | e^{-i\beta J_y / \hbar} | j, m \rangle.\]</p><p>The explicit expression for <span>$d$</span> is [Eq. (7.56)]</p><p class="math-container">\[d^{(j)}_{m&#39;, m}(\beta)
=
\sum_k (-1)^{k+m&#39;-m}
\frac{\sqrt{(j+m)!(j-m)!(j+m&#39;)!(j-m&#39;)!}}
{(j-m&#39;-k)!(j+m-k)!(k+m&#39;-m)!k!}
\left(\cos\frac{\beta}{2}\right)^{2j+m-m&#39;-2k}
\left(\sin\frac{\beta}{2}\right)^{m&#39;-m+2k}.\]</p><p>In Sec. 7.2.6, we find that if the operator <span>$\hat{R}(\alpha, \beta, \gamma)$</span> rotates a vector pointing in the <span>$(\theta, \phi)$</span> to a vector pointing in the <span>$(\theta&#39;, \phi&#39;)$</span> direction, then the spherical harmonics transform as [Eq. (7.70)]</p><p class="math-container">\[Y_{\ell, m}^\ast (\theta&#39;, \phi&#39;)
=
\sum_{m&#39;} D^{(\ell)}_{m, m&#39;}(\alpha, \beta, \gamma) Y_{\ell, m&#39;}^\ast (\theta, \phi).\]</p><p>In Appendix B.1, we find that the spherical coordinates are related to Cartesian coordinates in the usual (physicist&#39;s) way, and Eqs. (B.25)‚Äî(B.27) give the components of the angular-momentum operator in spherical coordinates as</p><p class="math-container">\[\begin{aligned}
L_x &amp;= i \hbar \left(
    \sin\phi \frac{\partial}{\partial \theta}
    + \cot\theta \cos\phi \frac{\partial}{\partial \phi}
\right),
\\
L_y &amp;= i \hbar \left(
    -\cos\phi \frac{\partial}{\partial \theta}
    + \cot\theta \sin\phi \frac{\partial}{\partial \phi}
\right),
\\
L_z &amp;= -i \hbar \frac{\partial}{\partial \phi}.
\end{aligned}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../details/">¬´ Details</a><a class="docs-footer-nextpage" href="../../literate_output/euler_angular_momentum/"><span>$L_j$</span> and <span>$R_j$</span> with Euler angles ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 25 February 2025 18:08">Tuesday 25 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
