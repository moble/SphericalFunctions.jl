<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Conventions · SphericalFunctions.jl</title><meta name="title" content="Conventions · SphericalFunctions.jl"/><meta property="og:title" content="Conventions · SphericalFunctions.jl"/><meta property="twitter:title" content="Conventions · SphericalFunctions.jl"/><meta name="description" content="Documentation for SphericalFunctions.jl."/><meta property="og:description" content="Documentation for SphericalFunctions.jl."/><meta property="twitter:description" content="Documentation for SphericalFunctions.jl."/><meta property="og:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/conventions/"/><meta property="twitter:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/conventions/"/><link rel="canonical" href="https://moble.github.io/SphericalFunctions.jl/stable/conventions/conventions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SphericalFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../transformations/"><span>$s$</span>-SHT Transformations</a></li><li><a class="tocitem" href="../../wigner_matrices/">Wigner&#39;s <span>$𝔇$</span> and <span>$d$</span> matrices</a></li><li><a class="tocitem" href="../../sYlm/"><span>${}_{s}Y_{\ell,m}$</span> functions</a></li><li><a class="tocitem" href="../../operators/">Differential operators</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../internal/">Internal functions</a></li><li><a class="tocitem" href="../../functions/">Complete function list</a></li></ul></li><li><span class="tocitem">Conventions</span><ul><li class="is-active"><a class="tocitem" href>Conventions</a><ul class="internal"><li><a class="tocitem" href="#Three-dimensional-space"><span>Three-dimensional space</span></a></li><li><a class="tocitem" href="#Four-dimensional-space:-Quaternions-and-rotations"><span>Four-dimensional space: Quaternions and rotations</span></a></li><li><a class="tocitem" href="#Rotations"><span>Rotations</span></a></li></ul></li><li><a class="tocitem" href="../comparisons/">Comparisons</a></li></ul></li><li><span class="tocitem">Notes</span><ul><li><a class="tocitem" href="../../notes/H_recursions/">Algorithm for computing <span>$H$</span></a></li><li><a class="tocitem" href="../../notes/sampling_theorems/">Sampling theorems and transformations of spin-weighted spherical harmonics</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Conventions</a></li><li class="is-active"><a href>Conventions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Conventions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl/blob/main/docs/src/conventions/conventions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Conventions"><a class="docs-heading-anchor" href="#Conventions">Conventions</a><a id="Conventions-1"></a><a class="docs-heading-anchor-permalink" href="#Conventions" title="Permalink"></a></h1><p>In the following subsections, we work through all the conventions used in this package, starting from first principles to motivate the choices and ensure that each step is on firm footing.  First, we can just list the most important conventions.  Note that we will use Euler angles and spherical coordinates here.  It is almost always a bad idea to use Euler angles in <em>computing</em>; quaternions are clearly the preferred representation for numerous reasons.  However, Euler angles are important for (a) comparing to other sources, and (b) performing <em>analytic</em> integrations.  These are the only two uses we will make of Euler angles.</p><ol><li>Right-handed Cartesian coordinates <span>$(x, y, z)$</span> and unit basis vectors <span>$(𝐱, 𝐲, 𝐳)$</span>.</li><li>Spherical coordinates <span>$(r, \theta, \phi)$</span> and unit basis vectors <span>$(𝐫, \boldsymbol{\theta}, \boldsymbol{\phi})$</span>.  The &quot;polar angle&quot; <span>$\theta \in [0, \pi]$</span> measures the angle between the specified direction and the positive <span>$𝐳$</span> axis.  The &quot;azimuthal angle&quot; <span>$\phi \in [0, 2\pi)$</span> measures the angle between the projection of the specified direction onto the <span>$𝐱$</span>-<span>$𝐲$</span> plane and the positive <span>$𝐱$</span> axis, with the positive <span>$𝐲$</span> axis corresponding to the positive angle <span>$\phi = \pi/2$</span>.</li><li>Quaternions <span>$𝐐 = W + X𝐢 + Y𝐣 + Z𝐤$</span>, where <span>$𝐢𝐣𝐤 = -1$</span>. In software, this quaternion is represented by <span>$(W, X, Y, Z)$</span>. We will depict a three-dimensional vector <span>$𝐯 = v_x 𝐱 + v_y 𝐲 + v_z 𝐳$</span> interchangeably as a quaternion <span>$v_x 𝐢 + v_y 𝐣 + v_z 𝐤$</span>.</li><li>A rotation represented by the unit quaternion <span>$𝐑$</span> acts on a vector <span>$𝐯$</span> as <span>$𝐑\, 𝐯\, 𝐑^{-1}$</span>.</li><li>Where relevant, rotations will be assumed to be right-handed, so that a quaternion characterizing the rotation through an angle <span>$\vartheta$</span> about a unit vector <span>$𝐮$</span> can be expressed as <span>$𝐑 = \exp(\vartheta 𝐮/2)$</span>.  Note that <span>$-𝐑$</span> would deliver the same rotation, which is why the group of unit quaternions <span>$\mathrm{Spin}(3) = \mathrm{SU}(2)$</span> is a <em>double cover</em> of the group of rotations <span>$\mathrm{SO}(3)$</span>.</li><li>Euler angles parametrize a unit quaternion as <span>$𝐑 = \exp(\alpha 𝐤/2)\, \exp(\beta 𝐣/2)\, \exp(\gamma 𝐤/2)$</span>.  The angles <span>$\alpha$</span> and <span>$\beta$</span> take values in <span>$[0, 2\pi)$</span>.  The angle <span>$\beta$</span> takes values in <span>$[0, 2\pi]$</span> to parametrize the group of unit quaternions <span>$\mathrm{Spin}(3) = \mathrm{SU}(2)$</span>, or in <span>$[0, \pi]$</span> to parametrize the group of rotations <span>$\mathrm{SO}(3)$</span>.</li><li>A point on the unit sphere with spherical coordinates <span>$(\theta, \phi)$</span> can be represented by Euler angles <span>$(\alpha, \beta, \gamma) = (\phi, \theta, 0)$</span>.  The rotation with these Euler angles takes the positive <span>$𝐳$</span> axis to the specified direction. In particular, any function of spherical coordinates can be promoted to a function on Euler angles using this identification.</li><li>For a complex-valued function <span>$f(𝐑)$</span>, we define two operators, the left and right Lie derivatives:<p class="math-container">\[L_𝐮 f(𝐑) = \left.-i \frac{d}{d\epsilon}\right|_{\epsilon=0}
f\left(e^{\epsilon 𝐮/2}\, 𝐑\right)
\qquad \text{and} \qquad
R_𝐮 f(𝐑) = \left.-i \frac{d}{d\epsilon}\right|_{\epsilon=0}
f\left(𝐑\, e^{\epsilon 𝐮/2}\right),\]</p>where <span>$𝐮$</span> can be any pure-vector quaternion.  In particular, <span>$L$</span> represents the standard angular-momentum operators, and we can compute the expressions in Euler angles for the basis vectors:<p class="math-container">\[\begin{aligned}
L_x = L_𝐢 &amp;= -i \left( \sin\alpha \frac{\partial}{\partial\beta} + \cos\alpha \cot\beta \frac{\partial}{\partial\alpha} \right), \\
L_y = L_𝐣 &amp;= -i \left( \cos\alpha \frac{\partial}{\partial\beta} - \sin\alpha \cot\beta \frac{\partial}{\partial\alpha} \right), \\
L_z = L_𝐤 &amp;= -i \frac{\partial}{\partial\alpha}.
\end{aligned}\]</p>Angular-momentum operators defined in Lie terms, translated to Euler angles and spherical coordinates.</li><li>Spherical harmonics</li><li>Wigner D-matrices</li><li>Spin-weighted spherical harmonics</li></ol><h2 id="Three-dimensional-space"><a class="docs-heading-anchor" href="#Three-dimensional-space">Three-dimensional space</a><a id="Three-dimensional-space-1"></a><a class="docs-heading-anchor-permalink" href="#Three-dimensional-space" title="Permalink"></a></h2><p>The space we are working in is naturally three-dimensional Euclidean space, so we start with a <a href="https://en.wikipedia.org/wiki/Right-hand_rule">right-handed</a> Cartesian coordinate system <span>$(x, y, z)$</span>.  These also give us the unit basis vectors <span>$(𝐱, 𝐲, 𝐳)$</span>.  Note that these basis vectors are assumed to have unit norm, but we omit the hats just to keep the notation simple.  Any vector in this space can be written as</p><p class="math-container">\[\mathbf{v} = v_x \mathbf{𝐱} + v_y \mathbf{𝐲} + v_z \mathbf{𝐳},\]</p><p>in which case the Euclidean norm is given by</p><p class="math-container">\[\| \mathbf{v} \| = \sqrt{v_x^2 + v_y^2 + v_z^2}.\]</p><p>Equivalently, we can write the components of the Euclidean metric as</p><p class="math-container">\[g_{ij} = \left( \begin{array}{ccc}
  1 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1
\end{array} \right)_{ij}.\]</p><p>Note that, because the points of the space are in one-to-one correspondence with the vectors, we will frequently use a vector to label a point in space.</p><p>We will be working on the sphere, so it will be very convenient to use spherical coordinates <span>$(r, \theta, \phi)$</span>.  We choose the standard &quot;physics&quot; conventions for these, in which we relate to the Cartesian coordinates by</p><p class="math-container">\[\begin{aligned}
r &amp;= \sqrt{x^2 + y^2 + z^2} &amp;&amp;\in [0, \infty), \\
\theta &amp;= \arccos\left(\frac{z}{r}\right) &amp;&amp;\in [0, \pi], \\
\phi &amp;= \arctan\left(\frac{y}{x}\right) &amp;&amp;\in [0, 2\pi),
\end{aligned}\]</p><p>where we assume the <span>$\arctan$</span> in the expression for <span>$\phi$</span> is really the two-argument form that gives the correct quadrant.  The inverse transformation is given by</p><p class="math-container">\[\begin{aligned}
x &amp;= r \sin\theta \cos\phi, \\
y &amp;= r \sin\theta \sin\phi, \\
z &amp;= r \cos\theta.
\end{aligned}\]</p><p>We can use this to find the components of the metric in spherical coordinates:</p><p class="math-container">\[g_{i&#39;j&#39;}
= \sum_{i,j} \frac{\partial x^i}{\partial x^{i&#39;}} \frac{\partial x^j}{\partial x^{j&#39;}} g_{ij}
= \left( \begin{array}{ccc}
  1 &amp; 0 &amp; 0 \\
  0 &amp; r^2 &amp; 0 \\
  0 &amp; 0 &amp; r^2 \sin^2\theta
\end{array} \right)_{i&#39;j&#39;}.\]</p><p>The unit coordinate vectors in spherical coordinates are then</p><p class="math-container">\[\begin{aligned}
\mathbf{𝐫} &amp;= \sin\theta \cos\phi \mathbf{𝐱} + \sin\theta \sin\phi \mathbf{𝐲} + \cos\theta \mathbf{𝐳}, \\
\boldsymbol{\theta} &amp;= \cos\theta \cos\phi \mathbf{𝐱} + \cos\theta \sin\phi \mathbf{𝐲} - \sin\theta \mathbf{𝐳}, \\
\boldsymbol{\phi} &amp;= -\sin\phi \mathbf{𝐱} + \cos\phi \mathbf{𝐲},
\end{aligned}\]</p><p>where, again, we omit the hats on the unit vectors to keep the notation simple.</p><p>One seemingly obvious — but extremely important — fact is that the unit basis frame <span>$(𝐱, 𝐲, 𝐳)$</span> can be rotated onto <span>$(\boldsymbol{\theta}, \boldsymbol{\phi}, \mathbf{r})$</span> by first rotating through the &quot;polar&quot; angle <span>$\theta$</span> about the <span>$\mathbf{y}$</span> axis, and then through the &quot;azimuthal&quot; angle <span>$\phi$</span> about the <span>$\mathbf{z}$</span> axis.  This becomes important when we consider spin-weighted functions.</p><p>Integration in Cartesian coordinates is, of course, trivial as</p><p class="math-container">\[\int_{\mathbb{R}^3} f\, d^3\mathbf{r} = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f\, dx\, dy\, dz.\]</p><p>In spherical coordinates, the integrand involves the square-root of the determinant of the metric, so we have</p><p class="math-container">\[\int_{\mathbb{R}^3} f\, d^3\mathbf{r} = \int_0^\infty \int_0^\pi \int_0^{2\pi} f\, r^2 \sin\theta\, dr\, d\theta\, d\phi.\]</p><p>Restricting to the unit sphere, and normalizing so that the integral of 1 over the sphere is 1, we can simplify this to</p><p class="math-container">\[\int_{S^2} f\, d^2\Omega = \frac{1}{4\pi} \int_0^\pi \int_0^{2\pi} f\, \sin\theta\, d\theta\, d\phi.\]</p><h2 id="Four-dimensional-space:-Quaternions-and-rotations"><a class="docs-heading-anchor" href="#Four-dimensional-space:-Quaternions-and-rotations">Four-dimensional space: Quaternions and rotations</a><a id="Four-dimensional-space:-Quaternions-and-rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Four-dimensional-space:-Quaternions-and-rotations" title="Permalink"></a></h2><h3 id="Geometric-algebra"><a class="docs-heading-anchor" href="#Geometric-algebra">Geometric algebra</a><a id="Geometric-algebra-1"></a><a class="docs-heading-anchor-permalink" href="#Geometric-algebra" title="Permalink"></a></h3><p>Given the basis vectors <span>$(𝐱, 𝐲, 𝐳)$</span> and the Euclidean norm, we can define the <a href="https://en.wikipedia.org/wiki/Geometric_algebra">geometric algebra</a>.  The key feature is the geometric product, which is defined for any pair of vectors as <span>$𝐯$</span> and <span>$𝐰$</span> as</p><p class="math-container">\[𝐯 𝐰 = 𝐯 ⋅ 𝐰 + 𝐯 ∧ 𝐰,\]</p><p>where the dot product is the usual scalar product and the wedge product is the antisymmetric part of the tensor product — acting just like the standard <a href="https://en.wikipedia.org/wiki/Exterior_algebra">exterior product</a> from the algebra of <a href="https://en.wikipedia.org/wiki/Differential_form">differential forms</a>.  The geometric product is linear, associative, distributive, and has the property that</p><p class="math-container">\[𝐯𝐯 = \| 𝐯 \|^2.\]</p><p>The most useful properties of the geometric product are that parallel vectors commute with each other, while orthogonal vectors anticommute. Since the geometric product is linear, the product of any two vectors can be decomposed into parallel and orthogonal parts.</p><p>The basis for this entire space is then the set</p><p class="math-container">\[\begin{gather}
𝟏, \\
𝐱, 𝐲, 𝐳,\\
𝐱𝐲, 𝐱𝐳, 𝐲𝐳, \\
𝐱𝐲𝐳.
\end{gather}\]</p><p>The standard presentation of quaternions (including the confused historical development) uses different symbols for these last four basis elements:</p><p class="math-container">\[\begin{gather}
𝐢 = 𝐳𝐲 = -𝐲𝐳, \\
𝐣 = 𝐱𝐳 = -𝐳𝐱, \\
𝐤 = 𝐲𝐱 = -𝐱𝐲, \\
𝐈 = 𝐱𝐲𝐳.
\end{gather}\]</p><p>Note that each of these squares to -1.  For example, recalling that orthogonal vectors anticommute, the product is associative, and the product of a vector with itself is just its squared norm, we have</p><p class="math-container">\[𝐱𝐲𝐱𝐲 = -𝐱𝐲𝐲𝐱 = -𝐱(𝐲𝐲)𝐱 = -𝐱𝐱 = -1.\]</p><p>Any of these could act like the unit imaginary; <span>$𝐱𝐲$</span> is probably the canonical choice.</p><p><span>$𝐈$</span> is sometimes called the pseudoscalar.  Its inverse is <span>$𝐈^{-1} = 𝐳𝐲𝐱 = -𝐱𝐲𝐳$</span>, which can also serve as something very much like the <a href="https://en.wikipedia.org/wiki/Hodge_star_operator">Hodge star operator</a>,<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> mapping elements to their &quot;dual&quot; elements.  In particular, we have</p><p class="math-container">\[\begin{aligned}
𝐢 &amp;= 𝐈^{-1}𝐱, \\
𝐣 &amp;= 𝐈^{-1}𝐲, \\
𝐤 &amp;= 𝐈^{-1}𝐳.
\end{aligned}\]</p><p>We will see that <span>$𝐢$</span> generates right-handed rotations in the positive sense about <span>$𝐱$</span>, <span>$𝐣$</span> about <span>$𝐲$</span>, and <span>$𝐤$</span> about <span>$𝐳$</span>.  Moreover, this mapping between <span>$(𝐱, 𝐲, 𝐳)$</span> and <span>$(𝐢, 𝐣, 𝐤)$</span> is a vector-space isomorphism.  In fact, the reader who is not familiar with geometric algebra but is familiar with quaternions may be able to read an expression like <span>$𝐣 𝐱 𝐣⁻¹$</span> as if it is just an abuse of notation, and mentally replace <span>$𝐱$</span> with <span>$𝐢$</span> to read those symbols as a valid quaternion expression; both viewpoints are equally correct by the isomorphism.</p><h3 id="Quaternions-and-Euler-angles"><a class="docs-heading-anchor" href="#Quaternions-and-Euler-angles">Quaternions and Euler angles</a><a id="Quaternions-and-Euler-angles-1"></a><a class="docs-heading-anchor-permalink" href="#Quaternions-and-Euler-angles" title="Permalink"></a></h3><p>Note that there are different conventions for the signs of the <span>$(𝐢, 𝐣, 𝐤)$</span> basis.  Everyone agrees that <span>$𝐢² = 𝐣² = 𝐤² = -1$</span>, but we could easily flip the sign of any basis element, and these would still be satisfied.  The identifications we chose above are made to ensure that <span>$𝐢$</span> generates rotations about <span>$𝐱$</span>, and so on, but even that depends on how we define quaternions as acting on vectors (to be discussed below).  A different choice of the latter would result in all flipping the sign of all three basis elements, which is a convention that is commonly used — though almost exclusively in aerospace.  The key expressions that eliminate ambiguity are the multiplications</p><p class="math-container">\[\begin{aligned}
𝐢 𝐣 &amp;= 𝐤, \\
𝐣 𝐤 &amp;= 𝐢, \\
𝐤 𝐢 &amp;= 𝐣.
\end{aligned}\]</p><p>We can also use these rules above to determine <span>$𝐢𝐣𝐤 = -𝟏$</span>.  All four of these equations have flipped signs in other conventions.  See <a href="../../references/#SommerEtAl_2018">Sommer et al.</a> for a discussion of the different conventions.</p><p>We use coordinates <span>$(W, X, Y, Z)$</span> on the space of quaternions, so that a quaternion would be written as</p><p class="math-container">\[𝐐 = W𝟏 + X𝐢 + Y𝐣 + Z𝐤,\]</p><p>though we usually omit the <span>$𝟏$</span>.  The space of all quaternions is thus four dimensional.  The norm is just the standard Euclidean norm, so that the norm of a quaternion is</p><p class="math-container">\[\| 𝐐 \| = \sqrt{W^2 + X^2 + Y^2 + Z^2}.\]</p><p>An important operation is the conjugate, which is defined as</p><p class="math-container">\[\overline{𝐐} = W - X𝐢 - Y𝐣 - Z𝐤.\]</p><p>Note that the squared norm can be written as the quaternion times its conjugate.  The inverse of a quaternion is thus just the conjugate divided by the squared norm:</p><p class="math-container">\[𝐐^{-1} = \frac{\overline{𝐐}}{𝐐\overline{𝐐}} = \frac{\overline{𝐐}}{\| 𝐐 \|^2}.\]</p><p>The other important operation is exponentiation.  Since a scalar commutes with any quaternion, including a nonzero scalar component in the quaternion will simply multiply the result by the exponential of that scalar component.  Moreover, we will not have any use for such an exponential, so we assume that the argument to the exponential function is a &quot;pure&quot; quaternion — that is, one with zero scalar component.  Moreover, we write it as a unit quaternion <span>$𝐮$</span> times some real number <span>$\sigma$</span>.  In particular, note that <span>$𝐮^2 = -1$</span>, so that it acts like the imaginary unit, which means we already know how to exponentiate it:</p><p class="math-container">\[\exp(𝐮\, \sigma) = \cos\sigma + 𝐮\, \sin\sigma.\]</p><p>Note that the inverse of the result can be obtained simply by negating the argument, as usual.</p><p>Much as with standard three-dimensional space, we could introduce a generalization of spherical coordinates, though we use a slight variant: extended Euler coordinates.  We will see below how to interpret these as a series of rotations.  For now, we simply state the relation:</p><p class="math-container">\[\begin{aligned}
R &amp;= \sqrt{W^2 + X^2 + Y^2 + Z^2} &amp;&amp;\in [0, \infty), \\
\alpha &amp;= \arctan\frac{Z}{W} + \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi), \\
\beta &amp;= 2\arccos\sqrt{\frac{W^2+Z^2}{W^2+X^2+Y^2+Z^2}} &amp;&amp;\in [0, 2\pi], \\
\gamma &amp;= \arctan\frac{Z}{W} - \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi),
\end{aligned}\]</p><p>where we again assume the <span>$\arctan$</span> in the expressions for <span>$\alpha$</span> and <span>$\gamma$</span> is really the two-argument form that gives the correct quadrant.  Note that here, <span>$\beta$</span> ranges up to <span>$2\pi$</span> rather than just <span>$\pi$</span>, as in the standard Euler angles.  This is because we are describing the space of quaternions, rather than just the space of rotations.  If we restrict to <span>$R=1$</span>, we have exactly the group of unit quaternions <span>$\mathrm{Spin}(3)=\mathrm{SU}(2)$</span>, which is a double cover of the rotation group <span>$\mathrm{SO}(3)$</span>. This extended range for <span>$\beta$</span> is necessary to cover the entire space of quaternions; if we further restrict to <span>$[0, \pi)$</span>, we would only cover the space of rotations.  This and the inclusion of <span>$R$</span> identify precisely how this coordinate system extends the standard Euler angles.</p><p>The inverse transformation is given by</p><p class="math-container">\[\begin{aligned}
  W &amp;= R\, \cos\frac{β}{2} \cos\frac{α+γ}{2}, \\
  X &amp;= -R\, \sin\frac{β}{2} \sin\frac{α-γ}{2}, \\
  Y &amp;= R\, \sin\frac{β}{2} \cos\frac{α-γ}{2}, \\
  Z &amp;= R\, \cos\frac{β}{2} \sin\frac{α+γ}{2}.
\end{aligned}\]</p><p>As with the spherical coordinates, we can use this to find the components of the metric in our extended Euler coordinates:</p><p class="math-container">\[g_{i&#39;j&#39;}
= \sum_{i,j} \frac{\partial X^i}{\partial X^{i&#39;}} \frac{\partial X^j}{\partial X^{j&#39;}} g_{ij}
= \left( \begin{array}{cccc}
  1 &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; \frac{R^2}{4} &amp; 0 &amp; \frac{R^2 \cos\beta}{4} \\
  0 &amp; 0 &amp; \frac{R^2}{4} &amp; 0 \\
  0 &amp; \frac{R^2 \cos\beta}{4} &amp; 0 &amp; \frac{R^2}{4}
\end{array} \right)_{i&#39;j&#39;}.\]</p><p>Again, integration involves a square-root of the determinant of the metric, which reduces to <span>$R^3 |\sin\beta| / 8$</span>.  Note that — unlike with standard spherical coordinates — the absolute value is necessary because <span>$\beta$</span> ranges over the entire interval <span>$[0, 2\pi]$</span>.  The integral over the entire space of quaternions is then</p><p class="math-container">\[\int_{\mathbb{R}^4} f\, d^4𝐐
= \int_{-\infty}^\infty \int_{-\infty}^\infty \int_{-\infty}^\infty \int_{-\infty}^\infty f\, dW\, dX\, dY\, dZ
= \int_0^\infty \int_0^{2\pi} \int_0^{2\pi} \int_0^{2\pi} f\, \frac{R^3}{8} |\sin β|\, dR\, dα\, dβ\, dγ.\]</p><p>Restricting to the unit sphere, and normalizing so that the integral of 1 over the sphere is 1, we can simplify this to</p><p class="math-container">\[\int_{\mathrm{Spin}(3)} f\, d^3\Omega
= \frac{1}{16\pi^2} \int_0^{2\pi} \int_0^{2\pi} \int_0^{2\pi} f\, |\sin β|\, dα\, dβ\, dγ.\]</p><p>Finally, restricting to the space of rotations, we can further simplify this to</p><p class="math-container">\[\int_{\mathrm{SO}(3)} f\, d^3\Omega
= \frac{1}{8\pi^2} \int_0^{2\pi} \int_0^{\pi} \int_0^{2\pi} f\, \sin β\, dα\, dβ\, dγ.\]</p><h2 id="Rotations"><a class="docs-heading-anchor" href="#Rotations">Rotations</a><a id="Rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Rotations" title="Permalink"></a></h2><p>We restrict to a unit quaternion <span>$𝐑$</span>, for which <span>$W^2 + X^2 + Y^2 + Z^2 = 1$</span>.  Given this constraint we can, without loss of generality, write the quaternion as</p><p class="math-container">\[𝐑
= \exp\left(\frac{\rho}{2} \hat{\mathfrak{r}}\right)
= \cos\frac{\rho}{2} + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}},\]</p><p>where <span>$\rho$</span> is an angle of rotation and <span>$\hat{\mathfrak{r}}$</span> is a unit &quot;pure-vector&quot; quaternion.  We can multiply a vector <span>$𝐯$</span> as</p><p class="math-container">\[𝐑\, 𝐯\, 𝐑^{-1}.\]</p><p>Splitting <span>$𝐯 = 𝐯_⟂ + 𝐯_∥$</span> into components perpendicular and parallel to <span>$\hat{\mathfrak{r}}$</span>, we see that <span>$𝐯_∥$</span> commutes with <span>$𝐑$</span> and <span>$𝐑^{-1}$</span>, while <span>$𝐯_⟂$</span> anticommutes with <span>$\hat{\mathfrak{r}}$</span>.  To find the full rotation, we expand the product:</p><p class="math-container">\[\begin{aligned}
𝐑\, 𝐯\, 𝐑^{-1}
&amp;= 𝐯_∥
   + \left(\cos\frac{\rho}{2} + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right)
     𝐯_⟂
     \left(\cos\frac{\rho}{2} - \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right) \\
&amp;= 𝐯_∥
   + \left(\cos\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂\right)
     \left(\cos\frac{\rho}{2} - \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right) \\
&amp;= 𝐯_∥
   + \cos^2\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂
   - \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, 𝐯_⟂ \, \hat{\mathfrak{r}} - \sin^2\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂\, \hat{\mathfrak{r}} \\
&amp;= 𝐯_∥
   + \cos^2\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, [\hat{\mathfrak{r}}, 𝐯_⟂] - \sin^2\frac{\rho}{2}\, 𝐯_⟂ \\
&amp;= 𝐯_∥
   + \cos\rho\, 𝐯_⟂ + \sin\rho\, \hat{\mathfrak{r}}\times 𝐯_⟂
\end{aligned}\]</p><p>The final expression shows that this is precisely what we expect when rotating <span>$𝐯$</span> through an angle <span>$\rho$</span> (in a positive, right-handed sense) about the axis <span>$\hat{\mathfrak{r}}$</span>.</p><p>Note that the presence of two factors of <span>$𝐑$</span> in the expression for rotating a vector explains two things.  First, it explains why the angle of rotation is twice the angle of the quaternion: one factor of <span>$𝐑$</span> either commutes and cancels or anti-commutes and combines with the the other factor.  Second, it explains why the quaternion group is a double cover of the rotation group: negating <span>$𝐑$</span> results in the same rotation.  Thus, for any rotation, there are two (precisely opposite) quaternions that represent it.</p><h3 id="Euler-angles-and-spherical-coordinates"><a class="docs-heading-anchor" href="#Euler-angles-and-spherical-coordinates">Euler angles and spherical coordinates</a><a id="Euler-angles-and-spherical-coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Euler-angles-and-spherical-coordinates" title="Permalink"></a></h3><p>Now that we understand how rotations work, we can provide geometric intuition for the expressions given above for Euler angles.  The Euler angles <em>in our convention</em> represent an initial rotation through <span>$\gamma$</span> about the <span>$𝐳$</span> axis, followed by a rotation through <span>$\beta$</span> about the <span>$𝐲$</span> axis, and finally a rotation through <span>$\alpha$</span> about the <span>$𝐳$</span> axis.  Note that the axes are fixed, and not subject to any preceding rotations.  More precisely, we can write the unit quaternion as</p><p class="math-container">\[𝐑 = \exp\left(\frac{\alpha}{2} 𝐤\right)
    \exp\left(\frac{\beta}{2} 𝐣\right)
    \exp\left(\frac{\gamma}{2} 𝐤\right).\]</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Note that quaternions will only be spanned by elements made from   an even number of the basis vectors.  It turns out that those   with an odd number will produce reflections, rather than   rotations, when acting on a vector — as discussed below.  This   explains why quaternions are restricted to just those elements   with an even number to represent rotations.  For details see any   geometric algebra text, like <a href="../../references/#DoranLasenby_2010">Doran and Lasenby</a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../functions/">« Complete function list</a><a class="docs-footer-nextpage" href="../comparisons/">Comparisons »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 24 December 2024 05:47">Tuesday 24 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
