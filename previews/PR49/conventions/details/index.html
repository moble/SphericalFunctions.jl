<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Details · SphericalFunctions.jl</title><meta name="title" content="Details · SphericalFunctions.jl"/><meta property="og:title" content="Details · SphericalFunctions.jl"/><meta property="twitter:title" content="Details · SphericalFunctions.jl"/><meta name="description" content="Documentation for SphericalFunctions.jl."/><meta property="og:description" content="Documentation for SphericalFunctions.jl."/><meta property="twitter:description" content="Documentation for SphericalFunctions.jl."/><meta property="og:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/details/"/><meta property="twitter:url" content="https://moble.github.io/SphericalFunctions.jl/stable/conventions/details/"/><link rel="canonical" href="https://moble.github.io/SphericalFunctions.jl/stable/conventions/details/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/extras.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SphericalFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../transformations/"><span>$s$</span>-SHT Transformations</a></li><li><a class="tocitem" href="../../wigner_matrices/">Wigner&#39;s <span>$𝔇$</span> and <span>$d$</span> matrices</a></li><li><a class="tocitem" href="../../sYlm/"><span>${}_{s}Y_{\ell,m}$</span> functions</a></li><li><a class="tocitem" href="../../operators/">Differential operators</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../internal/">Internal functions</a></li><li><a class="tocitem" href="../../functions/">Complete function list</a></li></ul></li><li><span class="tocitem">Conventions</span><ul><li><a class="tocitem" href="../summary/">Summary</a></li><li class="is-active"><a class="tocitem" href>Details</a><ul class="internal"><li><a class="tocitem" href="#Three-dimensional-space"><span>Three-dimensional space</span></a></li><li><a class="tocitem" href="#Four-dimensional-space:-Quaternions-and-rotations"><span>Four-dimensional space: Quaternions and rotations</span></a></li><li><a class="tocitem" href="#Rotations"><span>Rotations</span></a></li><li><a class="tocitem" href="#Rotation-and-angular-momentum-operators"><span>Rotation and angular-momentum operators</span></a></li><li><a class="tocitem" href="#Wigner&#39;s-𝔇-matrices"><span>Wigner&#39;s 𝔇 matrices</span></a></li><li><a class="tocitem" href="#Representation-theory-/-harmonic-analysis"><span>Representation theory / harmonic analysis</span></a></li><li><a class="tocitem" href="#Recursion-relations"><span>Recursion relations</span></a></li></ul></li><li><a class="tocitem" href="../comparisons/">Comparisons</a></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../literate_output/euler_angular_momentum/"><span>$L_j$</span> and <span>$R_j$</span> with Euler angles</a></li></ul></li></ul></li><li><span class="tocitem">Notes</span><ul><li><a class="tocitem" href="../../notes/H_recursions/">Algorithm for computing <span>$H$</span></a></li><li><a class="tocitem" href="../../notes/sampling_theorems/">Sampling theorems and transformations of spin-weighted spherical harmonics</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Conventions</a></li><li class="is-active"><a href>Details</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Details</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl/blob/main/docs/src/conventions/details.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Details"><a class="docs-heading-anchor" href="#Details">Details</a><a id="Details-1"></a><a class="docs-heading-anchor-permalink" href="#Details" title="Permalink"></a></h1><p>This page carefully works through all the conventions used in this package, starting from first principles to motivate the choices and ensure that each step is on firm footing.  The <a href="../summary/#Summary">previous page</a> collects the results in a more concise form.</p><p>Note that we will use Euler angles and spherical coordinates here, but <em>they are not used internally in this package</em> — though conversion functions are available.  It is almost always a bad idea to use Euler angles in <em>computing</em>; quaternions are clearly the preferred representation for numerous reasons.  However, Euler angles are important for (a) comparing to other sources, and (b) performing <em>analytic</em> integrations.  These are the only two uses we will make of Euler angles.</p><h2 id="Three-dimensional-space"><a class="docs-heading-anchor" href="#Three-dimensional-space">Three-dimensional space</a><a id="Three-dimensional-space-1"></a><a class="docs-heading-anchor-permalink" href="#Three-dimensional-space" title="Permalink"></a></h2><p>The space we are working in is naturally three-dimensional Euclidean space, so we start with a <a href="https://en.wikipedia.org/wiki/Right-hand_rule">right-handed</a> Cartesian coordinate system <span>$(x, y, z)$</span>.  These also give us the unit basis vectors <span>$(𝐱, 𝐲, 𝐳)$</span>.  Note that these basis vectors are assumed to have unit norm, but we omit the hats just to keep the notation simple.  Any vector in this space can be written as</p><p class="math-container">\[\mathbf{v} = v_x \mathbf{𝐱} + v_y \mathbf{𝐲} + v_z \mathbf{𝐳},\]</p><p>in which case the Euclidean norm is given by</p><p class="math-container">\[\| \mathbf{v} \| = \sqrt{v_x^2 + v_y^2 + v_z^2}.\]</p><p>Equivalently, we can write the components of the Euclidean metric as</p><p class="math-container">\[g_{ij} = \left( \begin{array}{ccc}
  1 &amp; 0 &amp; 0 \\
  0 &amp; 1 &amp; 0 \\
  0 &amp; 0 &amp; 1
\end{array} \right)_{ij}.\]</p><p>Note that, because the points of the space are in one-to-one correspondence with the vectors, we will frequently use a vector to label a point in space.</p><p>We will be working on the sphere, so it will be very convenient to use spherical coordinates <span>$(r, \theta, \phi)$</span>.  We choose the standard &quot;physics&quot; conventions for these, in which we relate to the Cartesian coordinates by</p><p class="math-container">\[\begin{aligned}
r &amp;= \sqrt{x^2 + y^2 + z^2} &amp;&amp;\in [0, \infty), \\
\theta &amp;= \arccos\left(\frac{z}{r}\right) &amp;&amp;\in [0, \pi], \\
\phi &amp;= \arctan\left(\frac{y}{x}\right) &amp;&amp;\in [0, 2\pi),
\end{aligned}\]</p><p>where we assume the <span>$\arctan$</span> in the expression for <span>$\phi$</span> is really the two-argument form that gives the correct quadrant.  The inverse transformation is given by</p><p class="math-container">\[\begin{aligned}
x &amp;= r \sin\theta \cos\phi, \\
y &amp;= r \sin\theta \sin\phi, \\
z &amp;= r \cos\theta.
\end{aligned}\]</p><p>We can use this to find the components of the metric in spherical coordinates:</p><p class="math-container">\[g_{i&#39;j&#39;}
= \sum_{i,j} \frac{\partial x^i}{\partial x^{i&#39;}} \frac{\partial x^j}{\partial x^{j&#39;}} g_{ij}
= \left( \begin{array}{ccc}
  1 &amp; 0 &amp; 0 \\
  0 &amp; r^2 &amp; 0 \\
  0 &amp; 0 &amp; r^2 \sin^2\theta
\end{array} \right)_{i&#39;j&#39;}.\]</p><p>The unit coordinate vectors in spherical coordinates are then</p><p class="math-container">\[\begin{aligned}
\mathbf{𝐫} &amp;= \sin\theta \cos\phi \mathbf{𝐱} + \sin\theta \sin\phi \mathbf{𝐲} + \cos\theta \mathbf{𝐳}, \\
\boldsymbol{\theta} &amp;= \cos\theta \cos\phi \mathbf{𝐱} + \cos\theta \sin\phi \mathbf{𝐲} - \sin\theta \mathbf{𝐳}, \\
\boldsymbol{\phi} &amp;= -\sin\phi \mathbf{𝐱} + \cos\phi \mathbf{𝐲},
\end{aligned}\]</p><p>where, again, we omit the hats on the unit vectors to keep the notation simple.  Conversely, we can express the Cartesian basis vectors in terms of the spherical basis vectors as</p><p class="math-container">\[\begin{aligned}
\mathbf{𝐱} &amp;= \sin\theta \cos\phi \mathbf{𝐫} + \cos\theta \cos\phi \boldsymbol{\theta} - \sin\phi \boldsymbol{\phi}, 
\\
\mathbf{𝐲} &amp;= \sin\theta \sin\phi \mathbf{𝐫} + \cos\theta \sin\phi \boldsymbol{\theta} + \cos\phi \boldsymbol{\phi},
\\
\mathbf{𝐳} &amp;= \cos\theta \mathbf{𝐫} - \sin\theta \boldsymbol{\theta}.
\end{aligned}\]</p><p>One seemingly obvious — but extremely important — fact is that the unit basis frame <span>$(𝐱, 𝐲, 𝐳)$</span> can be rotated onto <span>$(\boldsymbol{\theta}, \boldsymbol{\phi}, \mathbf{r})$</span> by first rotating through the &quot;polar&quot; angle <span>$\theta$</span> about the <span>$\mathbf{y}$</span> axis, and then through the &quot;azimuthal&quot; angle <span>$\phi$</span> about the <span>$\mathbf{z}$</span> axis.  This becomes important when we consider spin-weighted functions.</p><p>Integration in Cartesian coordinates is, of course, trivial as</p><p class="math-container">\[\int_{\mathbb{R}^3} f\, d^3\mathbf{r} = \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f\, dx\, dy\, dz.\]</p><p>In spherical coordinates, the integrand involves the square-root of the determinant of the metric, so we have</p><p class="math-container">\[\int_{\mathbb{R}^3} f\, d^3\mathbf{r} = \int_0^\infty \int_0^\pi \int_0^{2\pi} f\, r^2 \sin\theta\, dr\, d\theta\, d\phi.\]</p><p>Restricting to the unit sphere, and normalizing so that the integral of 1 over the sphere is 1, we can simplify this to</p><p class="math-container">\[\int_{S^2} f\, d^2\Omega = \frac{1}{4\pi} \int_0^\pi \int_0^{2\pi} f\, \sin\theta\, d\theta\, d\phi.\]</p><h2 id="Four-dimensional-space:-Quaternions-and-rotations"><a class="docs-heading-anchor" href="#Four-dimensional-space:-Quaternions-and-rotations">Four-dimensional space: Quaternions and rotations</a><a id="Four-dimensional-space:-Quaternions-and-rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Four-dimensional-space:-Quaternions-and-rotations" title="Permalink"></a></h2><h3 id="Geometric-algebra"><a class="docs-heading-anchor" href="#Geometric-algebra">Geometric algebra</a><a id="Geometric-algebra-1"></a><a class="docs-heading-anchor-permalink" href="#Geometric-algebra" title="Permalink"></a></h3><p>Given the basis vectors <span>$(𝐱, 𝐲, 𝐳)$</span> and the Euclidean norm, we can define the <a href="https://en.wikipedia.org/wiki/Geometric_algebra">geometric algebra</a>.  The key feature is the geometric product, which is defined for any pair of vectors as <span>$𝐯$</span> and <span>$𝐰$</span> as</p><p class="math-container">\[𝐯 𝐰 = 𝐯 ⋅ 𝐰 + 𝐯 ∧ 𝐰,\]</p><p>where the dot product is the usual scalar product and the wedge product is the antisymmetric part of the tensor product — acting just like the standard <a href="https://en.wikipedia.org/wiki/Exterior_algebra">exterior product</a> from the algebra of <a href="https://en.wikipedia.org/wiki/Differential_form">differential forms</a>.  The geometric product is linear, associative, distributive, and has the property that</p><p class="math-container">\[𝐯𝐯 = \| 𝐯 \|^2.\]</p><p>The most useful properties of the geometric product are that parallel vectors commute with each other, while orthogonal vectors anticommute. Since the geometric product is linear, the product of any two vectors can be decomposed into parallel and orthogonal parts.</p><p>The basis for this entire space is then the set</p><p class="math-container">\[\begin{gather}
𝟏, \\
𝐱, 𝐲, 𝐳,\\
𝐱𝐲, 𝐱𝐳, 𝐲𝐳, \\
𝐱𝐲𝐳.
\end{gather}\]</p><p>The standard presentation of quaternions (including the confused historical development) uses different symbols for these last four basis elements:</p><p class="math-container">\[\begin{gather}
𝐢 = 𝐳𝐲 = -𝐲𝐳, \\
𝐣 = 𝐱𝐳 = -𝐳𝐱, \\
𝐤 = 𝐲𝐱 = -𝐱𝐲, \\
𝐈 = 𝐱𝐲𝐳.
\end{gather}\]</p><p>Note that each of these squares to -1.  For example, recalling that orthogonal vectors anticommute, the product is associative, and the product of a vector with itself is just its squared norm, we have</p><p class="math-container">\[𝐱𝐲𝐱𝐲 = -𝐱𝐲𝐲𝐱 = -𝐱(𝐲𝐲)𝐱 = -𝐱𝐱 = -1.\]</p><p>Any of these could act like the unit imaginary; <span>$𝐱𝐲$</span> is probably the canonical choice.</p><p><span>$𝐈$</span> is sometimes called the pseudoscalar.  Its inverse is <span>$𝐈^{-1} = 𝐳𝐲𝐱 = -𝐱𝐲𝐳$</span>, which can also serve as something very much like the <a href="https://en.wikipedia.org/wiki/Hodge_star_operator">Hodge star operator</a>,<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> mapping elements to their &quot;dual&quot; elements.  In particular, we have</p><p class="math-container">\[\begin{aligned}
𝐢 &amp;= 𝐈^{-1}𝐱, \\
𝐣 &amp;= 𝐈^{-1}𝐲, \\
𝐤 &amp;= 𝐈^{-1}𝐳.
\end{aligned}\]</p><p>We will see that <span>$𝐢$</span> generates right-handed rotations in the positive sense about <span>$𝐱$</span>, <span>$𝐣$</span> about <span>$𝐲$</span>, and <span>$𝐤$</span> about <span>$𝐳$</span>.  Moreover, this mapping between <span>$(𝐱, 𝐲, 𝐳)$</span> and <span>$(𝐢, 𝐣, 𝐤)$</span> is a vector-space isomorphism.  In fact, the reader who is not familiar with geometric algebra but is familiar with quaternions may be able to read an expression like <span>$𝐣 𝐱 𝐣⁻¹$</span> as if it is just an abuse of notation, and mentally replace <span>$𝐱$</span> with <span>$𝐢$</span> to read those symbols as a valid quaternion expression; both viewpoints are equally correct by the isomorphism.</p><h3 id="Quaternions-and-Euler-angles"><a class="docs-heading-anchor" href="#Quaternions-and-Euler-angles">Quaternions and Euler angles</a><a id="Quaternions-and-Euler-angles-1"></a><a class="docs-heading-anchor-permalink" href="#Quaternions-and-Euler-angles" title="Permalink"></a></h3><p>Note that there are different conventions for the signs of the <span>$(𝐢, 𝐣, 𝐤)$</span> basis.  Everyone agrees that <span>$𝐢² = 𝐣² = 𝐤² = -1$</span>, but we could easily flip the sign of any basis element, and these would still be satisfied.  The identifications we chose above are made to ensure that <span>$𝐢$</span> generates rotations about <span>$𝐱$</span>, and so on, but even that depends on how we define quaternions as acting on vectors (to be discussed below).  A different choice of the latter would result in all flipping the sign of all three basis elements, which is a convention that is commonly used — though almost exclusively in aerospace.  The key expressions that eliminate ambiguity are the multiplications</p><p class="math-container">\[\begin{aligned}
𝐢 𝐣 &amp;= 𝐤, \\
𝐣 𝐤 &amp;= 𝐢, \\
𝐤 𝐢 &amp;= 𝐣.
\end{aligned}\]</p><p>We can also use these rules above to determine <span>$𝐢𝐣𝐤 = -𝟏$</span>.  All four of these equations have flipped signs in other conventions.  See <a href="../../references/#SommerEtAl_2018">Sommer et al.</a> for a discussion of the different conventions.</p><p>We use coordinates <span>$(W, X, Y, Z)$</span> on the space of quaternions, so that a quaternion would be written as</p><p class="math-container">\[𝐐 = W𝟏 + X𝐢 + Y𝐣 + Z𝐤,\]</p><p>though we usually omit the <span>$𝟏$</span>.  The space of all quaternions is thus four dimensional.  The norm is just the standard Euclidean norm, so that the norm of a quaternion is</p><p class="math-container">\[\| 𝐐 \| = \sqrt{W^2 + X^2 + Y^2 + Z^2}.\]</p><p>An important operation is the conjugate, which is defined as</p><p class="math-container">\[\overline{𝐐} = W - X𝐢 - Y𝐣 - Z𝐤.\]</p><p>Note that the squared norm can be written as the quaternion times its conjugate.  Any nonzero quaternion has an inverse, which is just the conjugate divided by the squared norm:</p><p class="math-container">\[𝐐^{-1} = \frac{\overline{𝐐}}{𝐐\overline{𝐐}} = \frac{\overline{𝐐}}{\| 𝐐 \|^2}.\]</p><p>The other important operation is exponentiation.  Since a scalar commutes with any quaternion, including a nonzero scalar component in the quaternion will simply multiply the result by the exponential of that scalar component.  Moreover, we will not have any use for such an exponential, so we assume that the argument to the exponential function is a &quot;pure&quot; quaternion — that is, one with zero scalar component.  Moreover, we write it as a unit quaternion <span>$𝐮$</span> times some real number <span>$\sigma$</span>.  In particular, note that <span>$𝐮^2 = -1$</span>, so that it acts like the imaginary unit, which means we already know how to exponentiate it:</p><p class="math-container">\[\exp(𝐮\, \sigma) = \cos\sigma + 𝐮\, \sin\sigma.\]</p><p>Note that the inverse of the result can be obtained simply by negating the argument, as usual.</p><p>Much as with standard three-dimensional space, we could introduce a generalization of spherical coordinates, though we use a slight variant: extended Euler coordinates.  We will see below how to interpret these as a series of rotations.  For now, we simply state the relation:</p><p class="math-container">\[\begin{aligned}
R &amp;= \sqrt{W^2 + X^2 + Y^2 + Z^2} &amp;&amp;\in [0, \infty), \\
\alpha &amp;= \arctan\frac{Z}{W} + \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi), \\
\beta &amp;= 2\arccos\sqrt{\frac{W^2+Z^2}{W^2+X^2+Y^2+Z^2}} &amp;&amp;\in [0, 2\pi], \\
\gamma &amp;= \arctan\frac{Z}{W} - \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi),
\end{aligned}\]</p><p>where we again assume the <span>$\arctan$</span> in the expressions for <span>$\alpha$</span> and <span>$\gamma$</span> is really the two-argument form that gives the correct quadrant.  Note that here, <span>$\beta$</span> ranges up to <span>$2\pi$</span> rather than just <span>$\pi$</span>, as in the standard Euler angles.  This is because we are describing the space of quaternions, rather than just the space of rotations.  If we restrict to <span>$R=1$</span>, we have exactly the group of unit quaternions <span>$\mathrm{Spin}(3)=\mathrm{SU}(2)$</span>, which is a double cover of the rotation group <span>$\mathrm{SO}(3)$</span>. This extended range for <span>$\beta$</span> is necessary to cover the entire space of quaternions; if we further restrict to <span>$[0, \pi)$</span>, we would only cover the space of rotations.  This and the inclusion of <span>$R$</span> identify precisely how this coordinate system extends the standard Euler angles.</p><p>The inverse transformation is given by</p><p class="math-container">\[\begin{aligned}
  W &amp;= R\, \cos\frac{β}{2} \cos\frac{α+γ}{2}, \\
  X &amp;= -R\, \sin\frac{β}{2} \sin\frac{α-γ}{2}, \\
  Y &amp;= R\, \sin\frac{β}{2} \cos\frac{α-γ}{2}, \\
  Z &amp;= R\, \cos\frac{β}{2} \sin\frac{α+γ}{2}.
\end{aligned}\]</p><p>As with the spherical coordinates, we can use this to find the components of the metric in our extended Euler coordinates:</p><p class="math-container">\[g_{i&#39;j&#39;}
= \sum_{i,j} \frac{\partial X^i}{\partial X^{i&#39;}} \frac{\partial X^j}{\partial X^{j&#39;}} g_{ij}
= \left( \begin{array}{cccc}
  1 &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; \frac{R^2}{4} &amp; 0 &amp; \frac{R^2 \cos\beta}{4} \\
  0 &amp; 0 &amp; \frac{R^2}{4} &amp; 0 \\
  0 &amp; \frac{R^2 \cos\beta}{4} &amp; 0 &amp; \frac{R^2}{4}
\end{array} \right)_{i&#39;j&#39;}.\]</p><p>The unit basis vectors in extended Euler coordinates in terms of the unit basis vectors in quaternion coordinates are</p><p class="math-container">\[\begin{aligned}
\mathbf{𝐑} &amp;= \frac{1}{R} \left(
  \cos \frac{\beta}{2} \cos \frac{\alpha+\gamma}{2} 𝟏
  - \sin \frac{\beta}{2} \sin \frac{\alpha-\gamma}{2} 𝐢
  + \sin \frac{\beta}{2} \cos \frac{\alpha-\gamma}{2} 𝐣
  + \cos \frac{\beta}{2} \sin \frac{\alpha+\gamma}{2} 𝐤
\right), \\
\boldsymbol{\alpha} &amp;= \frac{R}{2} \left(
  -\cos \frac{\beta}{2} \sin \frac{\alpha+\gamma}{2} 𝟏
  - \sin \frac{\beta}{2} \cos \frac{\alpha-\gamma}{2} 𝐢
  - \sin \frac{\beta}{2} \sin \frac{\alpha-\gamma}{2} 𝐣
  + \cos \frac{\beta}{2} \cos \frac{\alpha+\gamma}{2} 𝐤
\right), \\
\boldsymbol{\beta} &amp;= \frac{R}{2} \left(
  -\sin \frac{\beta}{2} \cos \frac{\alpha+\gamma}{2} 𝟏
  - \cos \frac{\beta}{2} \sin \frac{\alpha-\gamma}{2} 𝐢
  + \cos \frac{\beta}{2} \cos \frac{\alpha-\gamma}{2} 𝐣
  - \sin \frac{\beta}{2} \sin \frac{\alpha+\gamma}{2} 𝐤
\right), \\
\boldsymbol{\gamma} &amp;= \frac{R}{2} \left(
  -\cos \frac{\beta}{2} \sin \frac{\alpha+\gamma}{2} 𝟏
  + \sin \frac{\beta}{2} \cos \frac{\alpha-\gamma}{2} 𝐢
  - \sin \frac{\beta}{2} \cos \frac{\alpha-\gamma}{2} 𝐣
  - \cos \frac{\beta}{2} \sin \frac{\alpha+\gamma}{2} 𝐤
\right).
\end{aligned}\]</p><p>Again, integration involves a square-root of the determinant of the metric, which reduces to <span>$R^3 |\sin\beta| / 8$</span>.  Note that — unlike with standard spherical coordinates — the absolute value is necessary because <span>$\beta$</span> ranges over the entire interval <span>$[0, 2\pi]$</span>.  The integral over the entire space of quaternions is then</p><p class="math-container">\[\int_{\mathbb{R}^4} f\, d^4𝐐
= \int_{-\infty}^\infty \int_{-\infty}^\infty \int_{-\infty}^\infty \int_{-\infty}^\infty f\, dW\, dX\, dY\, dZ
= \int_0^\infty \int_0^{2\pi} \int_0^{2\pi} \int_0^{2\pi} f\, \frac{R^3}{8} |\sin β|\, dR\, dα\, dβ\, dγ.\]</p><p>Restricting to the unit sphere, and normalizing so that the integral of 1 over the sphere is 1, we can simplify this to</p><p class="math-container">\[\int_{\mathrm{Spin}(3)} f\, d^3\Omega
= \frac{1}{16\pi^2} \int_0^{2\pi} \int_0^{2\pi} \int_0^{2\pi} f\, |\sin β|\, dα\, dβ\, dγ.\]</p><p>Finally, restricting to the space of rotations, we can further simplify this to</p><p class="math-container">\[\int_{\mathrm{SO}(3)} f\, d^3\Omega
= \frac{1}{8\pi^2} \int_0^{2\pi} \int_0^{\pi} \int_0^{2\pi} f\, \sin β\, dα\, dβ\, dγ.\]</p><h2 id="Rotations"><a class="docs-heading-anchor" href="#Rotations">Rotations</a><a id="Rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Rotations" title="Permalink"></a></h2><p>We restrict to a unit quaternion <span>$𝐑$</span>, for which <span>$W^2 + X^2 + Y^2 + Z^2 = 1$</span>.  Given this constraint we can, without loss of generality, write the quaternion as</p><p class="math-container">\[𝐑
= \exp\left(\frac{\rho}{2} \hat{\mathfrak{r}}\right)
= \cos\frac{\rho}{2} + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}},\]</p><p>where <span>$\rho$</span> is an angle of rotation and <span>$\hat{\mathfrak{r}}$</span> is a unit &quot;pure-vector&quot; quaternion.  We can multiply a vector <span>$𝐯$</span> as</p><p class="math-container">\[𝐑\, 𝐯\, 𝐑^{-1}.\]</p><p>Splitting <span>$𝐯 = 𝐯_⟂ + 𝐯_∥$</span> into components perpendicular and parallel to <span>$\hat{\mathfrak{r}}$</span>, we see that <span>$𝐯_∥$</span> commutes with <span>$𝐑$</span> and <span>$𝐑^{-1}$</span>, while <span>$𝐯_⟂$</span> anticommutes with <span>$\hat{\mathfrak{r}}$</span>.  To find the full rotation, we expand the product:</p><p class="math-container">\[\begin{aligned}
𝐑\, 𝐯\, 𝐑^{-1}
&amp;= 𝐯_∥
   + \left(\cos\frac{\rho}{2} + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right)
     𝐯_⟂
     \left(\cos\frac{\rho}{2} - \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right) \\
&amp;= 𝐯_∥
   + \left(\cos\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂\right)
     \left(\cos\frac{\rho}{2} - \sin\frac{\rho}{2}\, \hat{\mathfrak{r}}\right) \\
&amp;= 𝐯_∥
   + \cos^2\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂
   - \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, 𝐯_⟂ \, \hat{\mathfrak{r}} - \sin^2\frac{\rho}{2}\, \hat{\mathfrak{r}}\, 𝐯_⟂\, \hat{\mathfrak{r}} \\
&amp;= 𝐯_∥
   + \cos^2\frac{\rho}{2}\, 𝐯_⟂ + \sin\frac{\rho}{2}\, \cos\frac{\rho}{2}\, [\hat{\mathfrak{r}}, 𝐯_⟂] - \sin^2\frac{\rho}{2}\, 𝐯_⟂ \\
&amp;= 𝐯_∥
   + \cos\rho\, 𝐯_⟂ + \sin\rho\, \hat{\mathfrak{r}}\times 𝐯_⟂
\end{aligned}\]</p><p>The final expression shows that this is precisely what we expect when rotating <span>$𝐯$</span> through an angle <span>$\rho$</span> (in a positive, right-handed sense) about the axis <span>$\hat{\mathfrak{r}}$</span>.</p><p>Note that the presence of two factors of <span>$𝐑$</span> in the expression for rotating a vector explains two things.  First, it explains why the angle of rotation is twice the angle of the quaternion: one factor of <span>$𝐑$</span> either commutes and cancels or anti-commutes and combines with the the other factor.  Second, it explains why the quaternion group is a double cover of the rotation group: negating <span>$𝐑$</span> results in the same rotation.  Thus, for any rotation, there are two (precisely opposite) quaternions that represent it.</p><h3 id="Euler-angles-and-spherical-coordinates"><a class="docs-heading-anchor" href="#Euler-angles-and-spherical-coordinates">Euler angles and spherical coordinates</a><a id="Euler-angles-and-spherical-coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Euler-angles-and-spherical-coordinates" title="Permalink"></a></h3><p>Now that we understand how rotations work, we can provide geometric intuition for the expressions given above for Euler angles.  The Euler angles <em>in our convention</em> represent an initial rotation through <span>$\gamma$</span> about the <span>$𝐳$</span> axis, followed by a rotation through <span>$\beta$</span> about the <span>$𝐲$</span> axis, and finally a rotation through <span>$\alpha$</span> about the <span>$𝐳$</span> axis.  Note that the axes are fixed, and not subject to any preceding rotations.  More precisely, we can write the unit quaternion as</p><p class="math-container">\[𝐑 = \exp\left(\frac{\alpha}{2} 𝐤\right)
    \exp\left(\frac{\beta}{2} 𝐣\right)
    \exp\left(\frac{\gamma}{2} 𝐤\right).\]</p><p>One of the more important interpretations of a rotor is considering what it does to the basis triad <span>$(𝐱, 𝐲, 𝐳)$</span>.  In particular, the vector <span>$𝐳$</span> is rotated onto the point given by spherical coordinates <span>$(\theta, \phi) = (\beta, \alpha)$</span>, while <span>$𝐱$</span> and <span>$𝐲$</span> are rotated into the plane spanned by the unit basis vectors <span>$\boldsymbol{\theta}$</span> and <span>$\boldsymbol{\phi}$</span> corresponding to that point.  If <span>$\gamma = 0$</span> the rotation is precise, meaning that <span>$𝐱$</span> is rotated onto <span>$\boldsymbol{\theta}$</span> and <span>$𝐲$</span> onto <span>$\boldsymbol{\phi}$</span>; if <span>$\gamma ≠ 0$</span> then they are rotated within that plane by the angle <span>$\gamma$</span> about the <span>$\mathbf{r}$</span> axis. Thus, we identify the spherical coordinates <span>$(\theta, \phi)$</span> with the Euler angles <span>$(\alpha, \beta, \gamma) = (\phi, \theta, 0)$</span>.</p><h2 id="Rotation-and-angular-momentum-operators"><a class="docs-heading-anchor" href="#Rotation-and-angular-momentum-operators">Rotation and angular-momentum operators</a><a id="Rotation-and-angular-momentum-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-and-angular-momentum-operators" title="Permalink"></a></h2><h3 id="Complex-valued-functions"><a class="docs-heading-anchor" href="#Complex-valued-functions">Complex-valued functions</a><a id="Complex-valued-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Complex-valued-functions" title="Permalink"></a></h3><p>Starting with Cartesian coordinates and the Euclidean norm on <span>$\mathbb{R}^3$</span>, we have <em>constructed</em> the geometric algebra over that space, as well as the spaces <span>$\mathrm{Spin}(3) = \mathrm{SU}(2)$</span> (topologically <span>$S^3$</span>), <span>$\mathrm{SO}(3)$</span> (topologically <span>$\mathbb{RP}^3$</span>), and <span>$S^2$</span>.  We will be defining complex-valued functions on these spaces, and defining operators to construct and classify them.  In particular, because we have constructed the spaces, they are naturally supplied with coordinates that are effectively inherited from the original Cartesian system.  We will be using these coordinate systems to construct both the operators and functions.  However, it is important to note that the coordinate systems may have singularities, which means that the spaces of coordinates may have different topologies than the spaces they represent.  For example, Euler angles have topology <span>$S^1 \times I \times S^1$</span> instead of the <span>$S^3$</span> and <span>$\mathbb{RP}^3$</span> topologies of the spaces they represent; spherical coordinates have topology <span>$S^1 \times I$</span> instead of <span>$S^2$</span>.</p><p>Defining functions on the coordinate system of a space is subtly different from defining functions on the space itself.  For example, spin-weighted functions are generally written as functions of (<span>$S^2$</span>) spherical coordinates.  However, they <em>cannot</em> be defined as functions on <span>$S^2$</span> itself; some notion of a reference tangent direction is needed at each point.  The difference is that spherical <em>coordinates</em> supply a natural choice for the reference tangent direction: the unit vector in the <span>$\boldsymbol{\theta}$</span> direction. This supplies just enough information to define the spin-weighted functions — though this ends up not being a useful form when more general transformations or deeper understanding are needed.</p><p>Because of this variety of spaces, we will need to use function composition in several ways; functions defined on one space can be &quot;lifted&quot; or &quot;lowered&quot; to another via maps between the spaces.  In the diagram below, the function <span>$F$</span> can be used to define the function <span>$f$</span> via the mapping <span>$m$</span> as <span>$f = m \circ F$</span>.</p><div class="composition-diagram">
<?xml version='1.0' encoding='UTF-8'?>
<!-- This file was generated by dvisvgm 3.2.2 -->
<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='135.540542pt' height ='77.088398pt' viewBox='-77.707098 -79.853543 145.540542 99.088398'>
<g id='page1'>
<text class='f1' x='8.094022' y='-98.111224' transform='matrix(1 0 0 1 -75.80112 37.3849)'>A</text>
<text class='f1' x='135.870232' y='-98.111224' transform='matrix(1 0 0 1 -76.0934 37.3849)'>B</text>
<text class='f0' x='71.835977' y='-30.150075' transform='matrix(1 0 0 1 -75.66273 37.38493)'>C</text>
<path d='M-55.742164-63.2187H54.886736' stroke-width='.39848' stroke-miterlimit='10'/>
<path d='M53.0156-65.60941C53.3906-64.17582 54.234347-63.496133 55.085909-63.218789C54.234347-62.937539 53.3906-62.261758 53.0156-60.82816' stroke-width='.39848' stroke-miterlimit='10' stroke-linecap='round' stroke-linejoin='round'/>
<text class='f1' x='.064136' y='-30.150075' transform='matrix(1 0 0 1 -4.666016 -35.414)'>m</text>
<path d='M-58.027364-56.8789L-8.207034-3.7695' stroke-width='.39848' stroke-miterlimit='10' stroke-dasharray='2.78941 1.59395'/>
<path d='M-7.742183-6.769534C-8.531245-5.511715-8.449215-4.433593-8.070309-3.621092C-8.855465-4.05078-9.925779-4.203125-11.230462-3.499999' stroke-width='.39848' stroke-miterlimit='10' stroke-linecap='round' stroke-linejoin='round'/>
<text class='f1' x='.064136' y='-30.150075' transform='matrix(1 0 0 1 -41.341736 9.2371)'>f</text>
<path d='M57.839836-56.8789L7.785156-3.7656' stroke-width='.39848' stroke-miterlimit='10'/>
<path d='M10.808601-3.492188C9.507814-4.199216 8.433598-4.050779 7.648441-3.621093C8.027348-4.433593 8.113288-5.511721 7.33204-6.769528' stroke-width='.39848' stroke-miterlimit='10' stroke-linecap='round' stroke-linejoin='round'/>
<text class='f1' x='.064136' y='-30.150075' transform='matrix(1 0 0 1 34.957364 9.1264)'>F</text>
</g>
</svg>
</div><p>For example, <span>$A$</span> could be the space of spherical coordinates, <span>$B$</span> could be <span>$\mathrm{Spin}(3)$</span>, and <span>$F$</span> could be a spin-weighted function.  There are many maps from spherical coordinates into <span>$\mathrm{Spin}(3)$</span>; we expect that all such maps will be related by rotations from <span>$\mathrm{SO}(3)$</span>, and in some sense equivalent via some universality relation.  However, for singular maps — such as coordinate singularities where multiple coordinate values correspond to a single &quot;physical&quot; point — we find exceptions to the universality. These compositions will be useful, in that we can define functions on the &quot;largest&quot; available space, and extend them to any space that maps into the first.</p><p>In principle, our functions should be defined on <span>$\mathrm{Spin}(3)$</span> or even the quaternions in general, though in practice we will define them on the space of coordinates on those spaces.  In any case, we will classify the functions by their behavior with respect to actions of <span>$\mathrm{Spin}(3)$</span> on the argument to the function.  Therefore, we need to consider the general behavior of functions under such actions.</p><h3 id="Finite-rotations"><a class="docs-heading-anchor" href="#Finite-rotations">Finite rotations</a><a id="Finite-rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-rotations" title="Permalink"></a></h3><p>We work with functions <span>$f: A \to \mathbb{C}$</span>, where <span>$A$</span> is either the group of unit quaternions, or the full algebra of quaternions. Any non-zero quaternion can be expressed as <span>$e^\mathfrak{g}$</span> for some finite quaternion <span>$\mathfrak{g}$</span>, which is referred to as the &quot;generator&quot; of the action of <span>$e^\mathfrak{g}$</span>.  This can act on a function <span>$f$</span> by multiplying the argument by <span>$e^\mathfrak{g}$</span>. However, there is an ambiguity: we could multiply either on the left or the right:<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup></p><p class="math-container">\[f\left(\mathbf{Q}\right) \mapsto f\left(e^\mathfrak{g} \mathbf{Q}\right)
\qquad \text{or} \qquad
f\left(\mathbf{Q}\right) \mapsto f\left(\mathbf{Q} e^\mathfrak{g}\right).\]</p><p>There is an additional ambiguity, in that this action rotates the <em>argument</em> of the function, whereas we will often prefer to think in terms of rotating the <em>function</em> itself.  For example, our function may describe the measurement of some field in a particular coordinate system.  Here, the argument <span>$\mathbf{Q}$</span> describes a particular value of the coordinates, and <span>$e^\mathfrak{g}$</span> changes the point under consideration.  If, on the other hand <span>$e^\mathfrak{g}$</span> describes how the field itself is rotated, then we can write the rotated field as a function <span>$f&#39;$</span> which is related to the original function <span>$f$</span> by</p><p class="math-container">\[f&#39;\left(\mathbf{Q}\right) = f\left(e^{-\mathfrak{g}} \mathbf{Q}\right)
\qquad \text{or} \qquad
f&#39;\left(\mathbf{Q}\right) = f\left(\mathbf{Q} e^{-\mathfrak{g}}\right).\]</p><p>Note that the exponent is negated, because the action of <span>$e^\mathfrak{g}$</span> on the argument is the inverse of the action of <span>$e^{-\mathfrak{g}}$</span> on the function.  This is a general property of the action of a group on a space, and is a consequence of the group action being a homomorphism.</p><p>To validate the signs here, it may be helpful to work through a simple example involving the sphere <span>$S^2$</span>.  We define a function on spherical coordinates as</p><p class="math-container">\[f(\theta, \phi) = \sin\theta \sin\phi.\]</p><p>Recall that we can map the spherical coordinates into the Euler angles, and the Euler angles into the quaternion</p><p class="math-container">\[(\theta, \phi) \mapsto (\phi, \theta, 0) \mapsto \mathbf{Q}
=
\exp\left(\frac{\phi}{2} \mathbf{k}\right)
\exp\left(\frac{\theta}{2} \mathbf{j}\right).\]</p><p>It is straightforward to see that we can write <span>$f$</span> as a function of <span>$\mathbf{Q}$</span> as</p><p class="math-container">\[f(\mathbf{Q}) = \left\langle \mathbf{Q}\, \mathbf{k}\, \mathbf{Q}^{-1} \right\rangle_{\mathbf{j}},\]</p><p>where the angle brackets and subscript indicate that we are taking the <span>$\mathbf{j}$</span> component.  That is, <span>$f$</span> is the <span>$y$</span> component of the vector <span>$\mathbf{z}$</span> rotated by <span>$\mathbf{Q}$</span>. </p><p>Now, we imagine rotating the field by an angle <span>$\alpha$</span> in the positive sense about the <span>$z$</span> axis.  Visualizing the situation, we can see that the rotated field should be represented by</p><p class="math-container">\[f&#39;(\theta, \phi) = \sin\theta \sin(\phi - \alpha).\]</p><p>For example, the rotated field evaluated at the point <span>$(\theta, \phi) = (\pi/2, 0)$</span> along the positive <span>$x$</span> axis should correspond to the original field evaluated at the point <span>$(\theta, \phi) = (\pi/2, -\alpha)$</span>.  This rotation is generated by <span>$\mathfrak{g} = \alpha \mathbf{k} / 2$</span>, which allows us to immediately calculate</p><p class="math-container">\[\begin{aligned}
f(e^\mathfrak{g} \mathbf{Q}) &amp;= \sin\theta \sin(\phi + \alpha) &amp;&amp;&amp;
f(\mathbf{Q} e^\mathfrak{g}) &amp;= \sin\theta \sin\phi \\
f(e^{-\mathfrak{g}} \mathbf{Q}) &amp;= \sin\theta \sin(\phi - \alpha) &amp;&amp;&amp;
f(\mathbf{Q} e^{-\mathfrak{g}}) &amp;= \sin\theta \sin\phi.
\end{aligned}\]</p><p>Thus, we see that left-multiplication by <span>$e^{-\mathfrak{g}}$</span> corresponds to rotation of the field while leaving the coordinates fixed; left-multiplication by <span>$e^\mathfrak{g}$</span> corresponds to rotation of the coordinates while leaving the field fixed; and right-multiplication by either doesn&#39;t affect this function at all.</p><p>Of course, right-multiplication using other choices for <span>$\mathfrak{g}$</span> could certainly have some effect on this function, and this choice of <span>$\mathfrak{g}$</span> could have an effect on other functions.  Note that right-multiplication can also be interpreted as left-multiplication, where the generator itself is rotated by the argument to the function.  That is,</p><p class="math-container">\[\begin{aligned}
f(\mathbf{Q} e^\mathfrak{g})
  &amp;= f(\mathbf{Q} e^{\mathfrak{g}} \mathbf{Q}^{-1} \mathbf{Q})
  = f(e^{\mathfrak{g}&#39;} \mathbf{Q}) \\
f(\mathbf{Q} e^{-\mathfrak{g}})
  &amp;= f(\mathbf{Q} e^{-\mathfrak{g}} \mathbf{Q}^{-1} \mathbf{Q})
  = f(e^{-\mathfrak{g}&#39;} \mathbf{Q}),
\end{aligned}\]</p><p>where <span>$\mathfrak{g}&#39; = \mathbf{Q} \mathfrak{g} \mathbf{Q}^{-1}$</span>.  In this example, <span>$\mathfrak{g}&#39;$</span> generates a rotation by an angle <span>$\alpha$</span> about the point in question, which leaves that point fixed, and since this is a scalar function it has no effect on the value.  Of course, we will see below that changing by a phase proportional to <span>$\alpha$</span> is the defining feature of a <em>spin-weighted</em> function.</p><h3 id="Differential-rotations"><a class="docs-heading-anchor" href="#Differential-rotations">Differential rotations</a><a id="Differential-rotations-1"></a><a class="docs-heading-anchor-permalink" href="#Differential-rotations" title="Permalink"></a></h3><p>We now define a pair of operators that differentiate a function with respect to infinitesimal rotations we apply to the functions themselves:</p><p class="math-container">\[\begin{aligned}
L_{\mathfrak{g}} f(\mathbf{Q}) &amp;= \lambda \left. \frac{\partial} {\partial \theta} f \left( e^{-\theta \mathfrak{g} / 2} \mathbf{Q} \right) \right|_{\theta=0}, \\
R_{\mathfrak{g}} f(\mathbf{Q}) &amp;= \rho \left. \frac{\partial} {\partial \theta} f \left( \mathbf{Q} e^{-\theta \mathfrak{g} / 2} \right) \right|_{\theta=0}.
\end{aligned}\]</p><p>Here, we have introduced the constants <span>$\lambda$</span> and <span>$\rho$</span> because we will actually be able to derive their values — up to signs — based on the requirement that raising and lowering operators exist for each.  Finally, we will choose the signs based on demands that these operators correspond as naturally as possible to the standard canonical angular-momentum operators.</p><p>Note that when composing operators, it is critical to keep track of the order of operations, which may look slightly unnatural:</p><p class="math-container">\[\begin{aligned}
  L_\mathfrak{g} L_\mathfrak{h} f(\mathbf{Q})
  % &amp;= \left. \lambda \frac{\partial} {\partial \gamma} f&#39;\left(e^{-\gamma \mathfrak{g} / 2} \mathbf{Q} \right) \right|_{\gamma=0}, \\
  &amp;= \left. \lambda^2 \frac{\partial} {\partial \gamma} \frac{\partial} {\partial \eta} f\left(e^{-\eta \mathfrak{h} / 2} e^{-\gamma \mathfrak{g} / 2} \mathbf{Q} \right) \right|_{\gamma=\eta=0}, \\
  R_\mathfrak{g} R_\mathfrak{h} f(\mathbf{Q})
  % &amp;= \rho \left. \frac{\partial} {\partial \gamma} f&#39; \left( \mathbf{Q} e^{-\gamma \mathfrak{g} / 2} \right) \right|_{\gamma=0} \\
  &amp;= \left. \rho^2 \frac{\partial} {\partial \gamma} \frac{\partial} {\partial \eta} f\left( \mathbf{Q} e^{-\gamma \mathfrak{g} / 2} e^{-\eta \mathfrak{h} / 2} \right) \right|_{\gamma=\eta=0}.
\end{aligned}\]</p><p>We can prove the first of these, for example, by defining <span>$f&#39;(\mathbf{Q}) = L_\mathfrak{h} f(\mathbf{Q})$</span>, then applying the definition of <span>$L_\mathfrak{g}$</span> to <span>$f&#39;(\mathbf{Q})$</span>, and finally substituting the definition of <span>$f&#39;$</span> back in.  If we failed to use the correct order of operations, we would get sign errors when trying to evaluate the commutators.</p><p>These operators have some nice properties.  For any scalar <span>$s$</span>, we have</p><p class="math-container">\[\begin{aligned}
L_{s \mathfrak{g}} &amp;= s L_{\mathfrak{g}}, \\
R_{s \mathfrak{g}} &amp;= s R_{\mathfrak{g}}.
\end{aligned}\]</p><p>Given any basis <span>$\mathbf{e}_n$</span> for the quaternions, we can use the multivariable chain rule to expand the operators in terms of components:</p><p class="math-container">\[\begin{aligned}
L_{\mathfrak{g}} &amp;= \sum_n g_n\, L_{\mathbf{e}_n}, \\
R_{\mathfrak{g}} &amp;= \sum_n g_n\, R_{\mathbf{e}_n}.
\end{aligned}\]</p><p>This implies that vector addition holds more generally:</p><p class="math-container">\[\begin{aligned}
L_{\mathfrak{g} + \mathfrak{h}} &amp;= L_{\mathfrak{g}} + L_{\mathfrak{h}} \\
R_{\mathfrak{g} + \mathfrak{h}} &amp;= R_{\mathfrak{g}} + R_{\mathfrak{h}}.
\end{aligned}\]</p><p>Moreover, we can show that these operators form a Lie algebra with the commutator as the Lie bracket.  That is, we have</p><p class="math-container">\[\begin{aligned}
[L_{\mathfrak{g}}, L_{\mathfrak{h}}]
    &amp;= \frac{\lambda}{2} L_{[\mathfrak{g}, \mathfrak{h}]},
\\
[R_{\mathfrak{g}}, R_{\mathfrak{h}}]
    &amp;= -\frac{\rho}{2} R_{[\mathfrak{g}, \mathfrak{h}]},
\\
[L_{\mathfrak{g}}, R_{\mathfrak{h}}] &amp;= 0.
\end{aligned}\]</p><p>Conventionally, we single out the <span>$\mathbf{z}$</span> axis — or equivalently the generator <span>$\mathbf{k} = \mathbf{y}\mathbf{x}$</span> — as a sort of fiducial axis, and <span>$L_z = L_\mathbf{k}$</span> and <span>$R_z = R_\mathbf{k}$</span> as the fiducial operators.  Then, <em>by definition</em>, their raising operators <span>$L_+$</span> and <span>$R_+$</span> and lowering operators <span>$L_-$</span> and <span>$R_-$</span> satisfy </p><p class="math-container">\[\begin{aligned}
[L_z, L_\pm] &amp;= \pm L_\pm, \\
[R_z, R_\pm] &amp;= \pm R_\pm.
\end{aligned}\]</p><p>Assuming that the raising and lowering operators can be written as linear combinations of the basis operators, these equations imply that they have no component proportional <span>$L_\mathbf{z}$</span>, and that both of the remaining components must be nonzero.  This actually allows us to deduce that <span>$\lambda^2 = \rho^2 = -1$</span>.  This, in turn, allows us to deduce the values of the raising and lowering operators up to an overall factor.  Conventionally the factor is chosen so that</p><p class="math-container">\[\begin{aligned}
L_\pm &amp;= L_\mathbf{x} \pm i L_\mathbf{y}, \\
R_\pm &amp;= R_\mathbf{x} \pm i R_\mathbf{y}.
\end{aligned}\]</p><ul><li>TODO: Impose <span>$R_z = s$</span></li><li>TODO: Impose Condon-Shortley condition (positive, real eigenvalues of <span>$R_\pm$</span>)</li><li>TODO: Show how the following happens</li></ul><p>Using these relations, we can actually solve for the constants <span>$\lambda$</span> and <span>$\rho$</span> up to a sign.  We find that</p><p class="math-container">\[\begin{aligned}
\lambda &amp;= i, \\
\rho &amp;= -i.
\end{aligned}\]</p><h3 id="Angular-momentum-operators-in-Euler-angles"><a class="docs-heading-anchor" href="#Angular-momentum-operators-in-Euler-angles">Angular-momentum operators in Euler angles</a><a id="Angular-momentum-operators-in-Euler-angles-1"></a><a class="docs-heading-anchor-permalink" href="#Angular-momentum-operators-in-Euler-angles" title="Permalink"></a></h3><ul><li>Express angular momentum operators in terms of Euler angles<ul><li>We just rewrite the <span>$R$</span> in the Lie definitions in terms of Euler angles, multiply by <span>$\exp(\theta/2)$</span>, rederive the new Euler angles from that result, and use the chain rule</li></ul></li><li>Show for both the three- and two-spheres</li><li>Show how they act on functions on the three-sphere</li></ul><p>The idea here is to express, e.g., <span>$e^{\theta \mathbf{e}_i / 2}\mathbf{R}_{\alpha, \beta, \gamma}$</span> in quaternion components, then solve for the new Euler angles <span>$\mathbf{R}_{\alpha&#39;, \beta&#39;, \gamma&#39;}$</span> in terms of the quaternion components, where these new angles all depend on <span>$\theta$</span>.  We then use the chain rule to express <span>$\partial_\theta$</span> in terms of <span>$\partial_{\alpha&#39;}$</span>, etc., which become <span>$\partial_\alpha$</span>, etc., when <span>$\theta=0$</span>.</p><p class="math-container">\[\begin{aligned}
  L_i f(\mathbf{R}_{\alpha, \beta, \gamma})
  &amp;=
  \left. -\mathbf{z} \frac{\partial} {\partial \theta} f \left( e^{\theta \mathbf{e}_i / 2} \mathbf{R}_{\alpha, \beta, \gamma} \right) \right|_{\theta=0} \\
  &amp;=
  \left. -\mathbf{z} \frac{\partial} {\partial \theta} f \left( \mathbf{R}_{\alpha&#39;, \beta&#39;, \gamma&#39;} \right) \right|_{\theta=0} \\
  &amp;=
  \left. -\mathbf{z} \left[ \frac{\partial \alpha&#39;} {\partial \theta}\frac{\partial} {\partial \alpha&#39;} + \frac{\partial \beta&#39;} {\partial \theta}\frac{\partial} {\partial \beta&#39;} + \frac{\partial \gamma&#39;} {\partial \theta}\frac{\partial} {\partial \gamma&#39;} \right] f \left( \mathbf{R}_{\alpha&#39;, \beta&#39;, \gamma&#39;} \right) \right|_{\theta=0} \\
  &amp;=
  -\mathbf{z} \left[ \frac{\partial \alpha&#39;} {\partial \theta}\frac{\partial} {\partial \alpha} + \frac{\partial \beta&#39;} {\partial \theta}\frac{\partial} {\partial \beta} + \frac{\partial \gamma&#39;} {\partial \theta}\frac{\partial} {\partial \gamma} \right]_{\theta=0} f \left( \mathbf{R}_{\alpha, \beta, \gamma} \right) \\
  K_i f(\mathbf{R}_{\alpha, \beta, \gamma})
  &amp;=
  -\mathbf{z} \left[ \frac{\partial \alpha&#39;&#39;} {\partial \theta}\frac{\partial} {\partial \alpha} + \frac{\partial \beta&#39;&#39;} {\partial \theta}\frac{\partial} {\partial \beta} + \frac{\partial \gamma&#39;&#39;} {\partial \theta}\frac{\partial} {\partial \gamma} \right]_{\theta=0} f \left( \mathbf{R}_{\alpha, \beta, \gamma} \right),
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\mathbf{R}_{\alpha, \beta, \gamma}
&amp;=
  R\, \cos\frac{β}{2} \cos\frac{α+γ}{2}
  -R\, \sin\frac{β}{2} \sin\frac{α-γ}{2} \mathbf{i}
  + R\, \sin\frac{β}{2} \cos\frac{α-γ}{2} \mathbf{j}
  + R\, \cos\frac{β}{2} \sin\frac{α+γ}{2} \mathbf{k}.
\\
e^{\theta \mathbf{u} / 2} \mathbf{R}_{\alpha, \beta, \gamma}
&amp;= \left(\cos\frac{\theta}{2} + \mathbf{u} \sin\frac{\theta}{2}\right) \mathbf{R}_{\alpha, \beta, \gamma}
\\
&amp;=
  R\, \cos\frac{\theta}{2} \cos\frac{β}{2} \cos\frac{α+γ}{2}
  -R\, \cos\frac{\theta}{2} \sin\frac{β}{2} \sin\frac{α-γ}{2} \mathbf{i}
  + R\, \cos\frac{\theta}{2} \sin\frac{β}{2} \cos\frac{α-γ}{2} \mathbf{j}
  + R\, \cos\frac{\theta}{2} \cos\frac{β}{2} \sin\frac{α+γ}{2} \mathbf{k}
\\
&amp;\quad +
  R\, \sin\frac{\theta}{2}\cos\frac{β}{2} \cos\frac{α+γ}{2} \mathbf{u}
  -R\, \sin\frac{\theta}{2}\sin\frac{β}{2} \sin\frac{α-γ}{2} \mathbf{u}\mathbf{i}
  + R\, \sin\frac{\theta}{2}\sin\frac{β}{2} \cos\frac{α-γ}{2} \mathbf{u}\mathbf{j}
  + R\, \sin\frac{\theta}{2}\cos\frac{β}{2} \sin\frac{α+γ}{2} \mathbf{u}\mathbf{k}
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\alpha &amp;= \arctan\frac{Z}{W} + \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi), \\
\beta &amp;= 2\arccos\sqrt{\frac{W^2+Z^2}{W^2+X^2+Y^2+Z^2}} &amp;&amp;\in [0, 2\pi], \\
\gamma &amp;= \arctan\frac{Z}{W} - \arctan\frac{-X}{Y} &amp;&amp;\in [0, 2\pi),
\end{aligned}\]</p><h3 id="Laplacians"><a class="docs-heading-anchor" href="#Laplacians">Laplacians</a><a id="Laplacians-1"></a><a class="docs-heading-anchor-permalink" href="#Laplacians" title="Permalink"></a></h3><p><a href="../../references/#Bander_1966">Bander and Itzykson [12]</a> show that Wigner&#39;s D matrices (extended to the full space of quaternions with arbitrary norm) are harmonic with respect to the Laplacian of the full 4-D space.  We also know that</p><p class="math-container">\[\Delta_{S^{n-1}} f(x) = \Delta_{\mathbb{R}^n} f(x/|x|),\]</p><p>and</p><p class="math-container">\[\Delta_{\mathbb{R}^n} f(x)
=
\frac{1}{r^{n-1}} \frac{\partial}{\partial r} \left( r^{n-1} \frac{\partial f}{\partial r} \right)
+
\frac{1}{r^2} \Delta_{S^{n-1}} f.\]</p><p>These imply that the restriction to the space of unit quaternions is not harmonic with respect to the Laplacian on the 3-sphere, but is an eigenfunction with eigenvalue <span>$-\ell(\ell+2)$</span>.</p><p class="math-container">\[\frac{1}{r^{n-1}} \frac{\partial}{\partial r} \left( r^{n-1} \frac{\partial f}{\partial r} \right)
=
\frac{1}{r^{n-1}} \left( r^{n-1} \frac{\partial}{\partial r} \frac{\partial f}{\partial r} \right)
+
\frac{1}{r^{n-1}} \frac{\partial}{\partial r} \left( r^{n-1} \right) \frac{\partial f}{\partial r}
=
\frac{\partial^2 f}{\partial r^2}
+
\frac{n-1}{r^{n-1}} r^{n-2} \frac{\partial f}{\partial r}
=
\frac{\partial^2 f}{\partial r^2}
+
\frac{n-1}{r} \frac{\partial f}{\partial r}\]</p><p class="math-container">\[\frac{\partial^2 f}{\partial r^2}
+
\frac{n-1}{r} \frac{\partial f}{\partial r}
=
\frac{f}{r^\ell} \frac{\partial^2 r^\ell}{\partial r^2}
+
\frac{f}{r^\ell} \frac{n-1}{r} \frac{\partial r^\ell}{\partial r}
=
\ell(\ell-1) \frac{f}{r^\ell} r^{\ell-2}
+
\ell \frac{f}{r^\ell} \frac{n-1}{r} r^{\ell-1}
=
\ell(\ell-1) \frac{f}{r^2}
+
\ell (n-1) \frac{f}{r^2}
=
\ell(\ell+n-2) \frac{f}{r^2}
\to
\ell(\ell+2) \frac{f}{r^2}\]</p><p>Note that <a href="../../references/#Lee_2012">Lee [13]</a> points out that there is a sign ambiguity in the Laplacian.  As I see it, the geometry community skews toward including a negative sign (which means that all eigenvalues are non-negative), while the physics community skews toward excluding it (which means that all eigenvalues are non-positive).  It&#39;s also easy to prove that on a closed and connected manifold, eigenfunctions with distinct eigenvalues are orthogonal, since</p><p class="math-container">\[(\lambda_u - \lambda_v) \int f_u f_v
= \int (\lambda_u f_u) f_v - \int f_u (\lambda_v f_v)
= \int (\Delta f_u) f_v - \int f_u (\Delta f_v) = 0\]</p><p>(the last equality by Green&#39;s theorem).  Since the eigenvalues are distinct, this can only be true if <span>$\int f_u f_v=0$</span>.</p><ul><li>TODO: Show the relationship between the spherical Laplacian and the angular momentum operator.</li><li>TODO: Show how <span>$D$</span> matrices are harmonic with respect to the Laplacian on the 3-sphere.</li></ul><h2 id="Wigner&#39;s-𝔇-matrices"><a class="docs-heading-anchor" href="#Wigner&#39;s-𝔇-matrices">Wigner&#39;s 𝔇 matrices</a><a id="Wigner&#39;s-𝔇-matrices-1"></a><a class="docs-heading-anchor-permalink" href="#Wigner&#39;s-𝔇-matrices" title="Permalink"></a></h2><p><a href="../../references/#Sakurai_1994">Sakurai [14]</a> says that</p><blockquote><p>[...] rotations affect physical systems, the state ket corresponding to a rotated system is expected to look different from the state ket corresponding to the original unrotated system. Given a rotation operation <span>$R$</span>, characterized by a <span>$3\times 3$</span> orthogonal matrix <span>$R$</span>, we associate an operator <span>$\mathscr{D}(R)$</span> in the appropriate ket space such that</p><p class="math-container">\[|\alpha\rangle_R = \mathscr{D}(R) |\alpha\rangle,\]</p><p><span>$|\alpha\rangle_R$</span> and <span>$|\alpha\rangle$</span> stand for the kets of the rotated and original system, respectively.</p></blockquote><p>If the field is represented as a function <span>$f(𝐑)$</span>, then rotating the field by <span>$e^{\epsilon 𝐮/2}$</span> is equivalent to rotating the argument of the function by <span>$e^{-\epsilon 𝐮/2}$</span>:</p><p class="math-container">\[\begin{aligned}
f\left(𝐑\right)
&amp;\to
f\left(e^{-\epsilon 𝐮/2}𝐑\right) \\
&amp;\approx
f\left(𝐑\right) + \epsilon \left. \frac{d}{d\epsilon} \right|_{\epsilon=0}
f\left(e^{-\epsilon 𝐮/2}𝐑\right) \\
&amp;=
f\left(𝐑\right) - i \epsilon L_𝐮 f\left(𝐑\right).
\end{aligned}\]</p><p>This final expression is precisely equivalent to Sakurai&#39;s Eq. (3.1.15):</p><p class="math-container">\[\mathscr{D}\left(\hat{\mathbf{n}}, d\phi \right)
=
1 - i \left( \mathbf{J} \cdot \hat{\mathbf{n}} \right) d\phi.\]</p><p>Now, we can write the eigenkets of <span>$L^2$</span> and <span>$L_z$</span> as <span>$|\ell, m\rangle$</span>, where the eigenvalues are <span>$\ell(\ell+1)$</span> and <span>$m$</span>, respectively.  Finally, define the 𝔇 matrix as (Eq. 3.5.42)</p><p class="math-container">\[𝔇^{(\ell)}_{m&#39;,m}(R)
=
\langle \ell, m&#39; | 𝔇(R) | \ell, m \rangle.\]</p><p>Sakurai notes the important result that (Eq. 3.5.46)</p><p class="math-container">\[𝔇^{(\ell)}_{m&#39;&#39;,m}(R_1\, R_2)
=
\sum_{m&#39;} 𝔇^{(\ell)}_{m&#39;&#39;,m&#39;}(R_1) 𝔇^{(\ell)}_{m&#39;,m}(R_2),\]</p><p>and we can readily find the essential behavior with respect to the first and last Euler angles (Eq. 3.5.50):</p><p class="math-container">\[\begin{aligned}
𝔇^{(\ell)}_{m&#39;,m}(\alpha, \beta, \gamma)
&amp;=
\langle \ell, m&#39; |
    \exp[-iL_z \alpha]\exp[-iL_y \beta]\exp[-iL_z \gamma]
| \ell, m \rangle \\
&amp;=
\exp[-i(m&#39; \alpha+m\gamma)]
\langle \ell, m&#39; | \exp[-iL_y \beta] | \ell, m \rangle.
\end{aligned}\]</p><p>Using</p><p class="math-container">\[L_y = (L₊ − L₋) / (2i)\]</p><p>we can expand</p><p class="math-container">\[exp[-iL_y β]
=
Σ_k (-iL_y β)^k / k!
=
Σ_k (L₋ - L₊)^k (β/2)^k / k!\]</p><p>Now, writing <span>$d_+(X) = [L_+, X]$</span>, Eq. (9) of https://arxiv.org/pdf/1707.03861 says</p><p class="math-container">\[(L₋ - L₊)^k = \sum_{j=0}^k \binom{k, j} ((L₋ - d_+)^j 1) (-L₊)^{k-j}\]</p><p>The sum will automatically be zero unless <span>$m+k-j ≤ ℓ$</span> — which means <span>$j ≥ m+k-ℓ$</span></p><p class="math-container">\[(-L₊)^{k-j}|ℓ,m\rangle = (-1)^{k-j} \sqrt{\frac{(\ell+m+k-j)!}{(\ell+m)!},\frac{(\ell-m)!}{(\ell-m-k+j)!}} |ℓ,m+k-j\rangle\]</p><p><span>$[L₊, L₋] = 2 L_z$</span></p><p><span>$[L_z, L_\pm] = \pm L_\pm$</span></p><p>I wonder if there&#39;s a nicer approach using the symmetry transformation Edmonds notes in Sec. 4.5 (and credits to Wigner) — or the presumably equivalent one McEwan and Wieux use (and credit Risbo):</p><p class="math-container">\[\exp\left[ \beta 𝐣 / 2 \right]
=
\exp\left[ \pi 𝐤 / 4 \right]
\exp\left[ \pi 𝐣 / 4 \right]
\exp\left[ \beta 𝐤 / 2 \right]
\exp\left[ -\pi 𝐣 / 4 \right]
\exp\left[ -\pi 𝐤 / 4 \right]\]</p><p>The 𝔇 matrices corresponding to the <span>$𝐤$</span> rotations are simple phases, which converts the problem into one of finding the 𝔇 matrices for the <span>$𝐣$</span> rotations through angles of <span>$\pm\pi/2$</span> — which are presumably simpler to compute.  See, e.g., Varshalovich&#39;s Eq. 4.16.(5), where they are given by purely combinatorial terms.</p><h2 id="Representation-theory-/-harmonic-analysis"><a class="docs-heading-anchor" href="#Representation-theory-/-harmonic-analysis">Representation theory / harmonic analysis</a><a id="Representation-theory-/-harmonic-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Representation-theory-/-harmonic-analysis" title="Permalink"></a></h2><ul><li>Representations show up in Fourier analysis on groups</li><li>Peter-Weyl theorem<ul><li>Generalizes Fourier analysis to compact groups</li><li>Has three parts, <a href="https://en.wikipedia.org/wiki/Peter%E2%80%93Weyl_theorem">as given by Wikipedia</a>:<ol><li>&quot;The matrix coefficients of irreducible representations of <span>$G$</span> are dense in the space <span>$C(G)$</span> of continuous complex-valued functions on <span>$G$</span>, and thus also in the space <span>$L^2(G)$</span> of square-integrable functions.&quot;</li><li>Unitary representations of <span>$G$</span> are completely reducible.</li><li>&quot;The regular representation of <span>$G$</span> on <span>$L^2(G)$</span> decomposes as the direct sum of all irreducible unitary representations. Moreover, the matrix coefficients of the irreducible unitary representations form an orthonormal basis of <span>$L^2(G)$</span>.&quot;</li></ol></li></ul></li><li>Representation theory of <span>$\mathbf{Spin}(3)$</span><ul><li>Show how the Lie algebra is represented by the angular-momentum operators</li><li>Show how the Lie group is represented by the Wigner D-matrices</li><li>Demonstrate that <span>$\mathfrak{D}$</span> is a representation</li><li>Demonstrate its behavior under left and right rotation</li><li>Demonstrate orthonormality</li></ul></li><li>Representation theory of <span>$\mathbf{SO}(3)$</span><ul><li>There are several places in <a href="../../references/#Folland_2016">Folland</a> (e.g., above corollary 5.48) where he mentions that representations of a quotient group are just representations that are trivial (evidently meaning mapping everything to the identity matrix) on the factor.  I can&#39;t find anywhere that he explains this explicitly, but it seems easy enough to show.  He might do it using characters.</li><li>For <span>$\mathbf{Spin}(3)$</span> and <span>$\mathbf{SO}(3)$</span>, the factor group is just <span>$\{1, -1\}$</span>.  Presumably, every representation acting on <span>$1$</span> will give the identity matrix, so that&#39;s trivial.  So we just need a criterion for when a representation is trivial on <span>$-1$</span>.  Noting that <span>$\exp(\pi \vec{v}) = -1$</span> for any <span>$\vec{v}$</span>, I think we can show that this requires <span>$m \in \mathbb{Z}$</span>.</li><li>Basically, the point is that the representations of <span>$\mathbf{SO}(3)$</span> are just the integer representations of <span>$\mathbf{Spin}(3)$</span>.</li></ul></li><li>Restrict to homogeneous space (S³ -&gt; S²)<ul><li>The circle group is a closed (normal?) subgroup of <span>$\mathbf{Spin}(3)$</span>, which we might implement as initial multiplication about a particular axis.</li><li>In Eq. (2.47) <a href="../../references/#Folland_2016">Folland (2016)</a> defines a functional taking a function on the group to a function on the homogeneous space by integrating over the factor (the circle group).  This gives you the spherical harmonics, but <em>not</em> the spin-weighted spherical harmonics — because the spin-weighted spherical harmonics cannot be defined on the 2-sphere.</li><li>Spin weight comes from Fourier analysis on the subgroup.</li><li>Representation matrices transfer to the homogeneous space, with sparsity patterns</li></ul></li></ul><p>Theorem 2.16 of <a href="../../references/#HansonYakovlev_2002">Hanson-Yakovlev</a> says that an orthonormal basis of a product of <span>$L^2$</span> spaces is given by the product of the orthonormal bases of the individual spaces. Furthermore, on page 354, they point out that <span>$\{(1/\sqrt{2\pi}) e^{im\phi}\}$</span> is an orthonormal basis of <span>$L^2(0,2\pi)$</span>, while the set <span>$\{1/c_{n,m} P_n^m(\cos\theta)$</span> is an orthonormal basis of <span>$L^2(0, \pi)$</span> in the <span>$\theta$</span> coordinate.  Therefore, the product of these two sets is an orthonormal basis of the product space <span>$L^2\left((0,2\pi) \times (0, \pi)\right)$</span>, which forms a coordinate space for <span>$S^2$</span>.  I would probably modify this to point out that <span>$(0,2\pi)$</span> is really <span>$S^1$</span>, and then we could extend it to point out that you can throw on another factor of <span>$S^1$</span> to cover <span>$S^3$</span>, which happens to give us the Wigner D-matrices.</p><h2 id="Recursion-relations"><a class="docs-heading-anchor" href="#Recursion-relations">Recursion relations</a><a id="Recursion-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Recursion-relations" title="Permalink"></a></h2><p><a href="../../references/#Gumerov_2001">Gumerov and Duraiswami (2001)</a> derive their recursion relations by differentiating solutions of the Helmholtz equation <span>$\nabla^2 \psi + k^2 \psi = 0$</span> as <span>$\tfrac{1}{k} \nabla \psi$</span>.  More precisely, they differentiate both sides of the equation relating one solution to its rotated form — which naturally involves Wigner&#39;s <span>$\mathfrak{D}$</span> matrix.  Using orthogonal basis functions for the solution, this allows them to equate terms on the two sides proportional to a given basis function, which leaves them with expressions involving sums of only the <span>$\mathfrak{D}$</span> matrices and some coefficients depending on the indices of the basis functions (and hence of <span>$\mathfrak{D}$</span>) on both sides of the equation.  Since <span>$\nabla$</span> is a 3-vector operator, this gives them three relations.</p><p>This, of course, is happening in 3-D space, since <span>$\psi$</span> is a function of location in the Helmholtz equation.  It seems likely to me, however, that we could use the 4-D (quaternionic) version of the functions.  Note that G&amp;D use <span>$\partial_z$</span> and <span>$\partial_x \pm i \partial_y$</span> as their operators to differentiate the functions — that is, the derivatives are with respect to Cartesian coordinates, which may be more similar to the right-derivative defined above.  However, I don&#39;t know that we&#39;ll necessarily be able to achieve the same results with just angular-momentum operators, since their operators do involve moving off of the sphere.  Maybe we&#39;d need to move off of the sphere in 4-D space to get comparable results.  Or maybe just use something like <span>$𝐫 ∧ L$</span>, which should also have 3 degrees of freedom.</p><p>The SWSHs/<span>$\mathfrak{D}$</span> functions can be naturally promoted to functions not just on the 3-sphere, but also in 4-D space just by allowing the quaternions to be non-unit quaternions.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Note that quaternions will only be spanned by elements made from   an even number of the basis vectors.  It turns out that those   with an odd number will produce reflections, rather than   rotations, when acting on a vector — as discussed below.  This   explains why quaternions are restricted to just those elements   with an even number to represent rotations.  For details see any   geometric algebra text, like <a href="../../references/#DoranLasenby_2010">Doran and Lasenby</a>.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>In group theory, this type of transformation is often referred   to as a &quot;translation&quot;, even when — as in this case — we would   usually describe these as rotations.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../summary/">« Summary</a><a class="docs-footer-nextpage" href="../comparisons/">Comparisons »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 25 February 2025 17:36">Tuesday 25 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
