<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>_sY_ellm functions ¬∑ SphericalFunctions.jl</title><meta name="title" content="_sY_ellm functions ¬∑ SphericalFunctions.jl"/><meta property="og:title" content="_sY_ellm functions ¬∑ SphericalFunctions.jl"/><meta property="twitter:title" content="_sY_ellm functions ¬∑ SphericalFunctions.jl"/><meta name="description" content="Documentation for SphericalFunctions.jl."/><meta property="og:description" content="Documentation for SphericalFunctions.jl."/><meta property="twitter:description" content="Documentation for SphericalFunctions.jl."/><meta property="og:url" content="https://moble.github.io/SphericalFunctions.jl/stable/sYlm/"/><meta property="twitter:url" content="https://moble.github.io/SphericalFunctions.jl/stable/sYlm/"/><link rel="canonical" href="https://moble.github.io/SphericalFunctions.jl/stable/sYlm/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../assets/extras.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SphericalFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../transformations/"><span>$s$</span>-SHT Transformations</a></li><li><a class="tocitem" href="../wigner_matrices/">Wigner&#39;s <span>$ùîá$</span> and <span>$d$</span> matrices</a></li><li class="is-active"><a class="tocitem" href><span>${}_{s}Y_{\ell,m}$</span> functions</a><ul class="internal"><li><a class="tocitem" href="#Docstrings"><span>Docstrings</span></a></li></ul></li><li><a class="tocitem" href="../operators/">Differential operators</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../internal/">Internal functions</a></li><li><a class="tocitem" href="../functions/">Complete function list</a></li></ul></li><li><span class="tocitem">Conventions</span><ul><li><a class="tocitem" href="../conventions/summary/">Summary of conventions</a></li><li><a class="tocitem" href="../conventions/details/">Details of conventions</a></li><li><a class="tocitem" href="../conventions/comparisons/">Comparisons</a></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../literate_output/euler_angular_momentum/"><span>$L_j$</span> and <span>$R_j$</span> with Euler angles</a></li></ul></li></ul></li><li><span class="tocitem">Notes</span><ul><li><a class="tocitem" href="../notes/H_recursions/">Algorithm for computing <span>$H$</span></a></li><li><a class="tocitem" href="../notes/sampling_theorems/">Sampling theorems and transformations of spin-weighted spherical harmonics</a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><span>${}_{s}Y_{\ell,m}$</span> functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><span>${}_{s}Y_{\ell,m}$</span> functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/moble/SphericalFunctions.jl/blob/main/docs/src/sYlm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="{}_{s}Y_{\\ell,m}-functions"><a class="docs-heading-anchor" href="#{}_{s}Y_{\\ell,m}-functions"><span>${}_{s}Y_{\ell,m}$</span> functions</a><a id="{}_{s}Y_{\\ell,m}-functions-1"></a><a class="docs-heading-anchor-permalink" href="#{}_{s}Y_{\\ell,m}-functions" title="Permalink"></a></h1><p>The spin-weighted spherical harmonics are an <a href="../references/#Boyle_2016">important set of functions defined on</a> the rotation group <span>$ùêíùêé(3)$</span>, or more generally, the spin group <span>$ùêíùê©ùê¢ùêß(3)$</span> that covers it.  They are eigenfunctions of <a href="../operators/#Differential-operators">the left- and right-Lie derivatives</a>, and are particularly useful in describing the angular dependence of polarized fields, like the electromagnetic field and gravitational-wave field.  Originally introduced by <a href="../references/#Newman_1966">Newman and Penrose [7]</a>, they are essentially components of Wigner&#39;s <span>$\frak{D}$</span> matrices:</p><p class="math-container">\[{}_{s}Y_{\ell,m}(\mathbf{R})
  = (-1)^s \sqrt{\frac{2\ell+1}{4\pi}} \, \frak{D}^{(\ell)}_{m, -s}(\mathbf{R}).\]</p><p>As such, they can be computed using the same <a href="../notes/H_recursions/#Algorithm-for-computing-H"><span>$H$</span> recursion</a> algorithm as the Wigner <span>$\frak{D}^{(\ell)}_{m, -s}$</span> matrices.  But because not all values of <span>$s \in -\ell:\ell$</span> are used, we can be much more efficient in both storage and computation time.</p><p>The user interface is very similar to the one for <a href="../wigner_matrices/#Wigner&#39;s-ùîá-and-d-matrices">Wigner&#39;s <span>$ùîá$</span> and <span>$d$</span> matrices</a>:</p><pre><code class="language-julia hljs">using Quaternionic
using SphericalFunctions

R = randn(RotorF64)
‚Ñì‚Çò‚Çê‚Çì = 8
s = -2
Y = sYlm_values(R, ‚Ñì‚Çò‚Çê‚Çì, s)</code></pre><p>Again, the results can take up a lot of memory, so for maximum efficiency when calling this function repeatedly with different <code>R</code> values, it is best to pre-allocate the necessary memory with the <a href="#SphericalFunctions.sYlm_prep"><code>sYlm_prep</code></a> function, and the pass that in as an argument to <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a>:</p><pre><code class="language-julia hljs">Y_storage = sYlm_prep(‚Ñì‚Çò‚Çê‚Çì, s)
Y = sYlm_values!(Y_storage, R, s)</code></pre><p>(Beware that, as noted in the documentation for <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a>, the output <code>Y</code> is just a reference to part of the <code>Y_storage</code> object, so you should not reuse <code>Y_storage</code> until you have copied or otherwise finished using <code>Y</code>.)</p><p>The output <code>Y</code> is a single vector of <code>Complex</code> numbers with the same base type as <code>R</code>.  The ordering of the elements is described in the documentation for <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a>.  It is also possible to efficiently view slices of this vector as a series of individual vectors using a <a href="#SphericalFunctions.sYlm_iterator"><code>sYlm_iterator</code></a>:</p><pre><code class="language-julia hljs">for (‚Ñì, YÀ°) in zip(0:‚Ñì‚Çò‚Çê‚Çì, sYlm_iterator(Y, ‚Ñì‚Çò‚Çê‚Çì))
    # Do something with the matrix YÀ°[‚Ñì+m‚Ä≤+1, ‚Ñì+m+1]
end</code></pre><h2 id="Docstrings"><a class="docs-heading-anchor" href="#Docstrings">Docstrings</a><a id="Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#Docstrings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFunctions.sYlm_values" href="#SphericalFunctions.sYlm_values"><code>SphericalFunctions.sYlm_values</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sYlm_values(R, ‚Ñì‚Çò‚Çê‚Çì, spin)
sYlm_values(Œ∏, œï, ‚Ñì‚Çò‚Çê‚Çì, spin)</code></pre><p>Compute values of the spin-weighted spherical harmonic <span>${}_{s}Y_{\ell, m}(R)$</span> for all <span>$\ell \leq \ell_\mathrm{max}$</span>.</p><p>See <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a> for details about the input and output values.</p><p>This function only appropriate when you need to evaluate the <span>${}_{s}Y_{\ell, m}$</span> for a single value of <code>R</code> or <code>Œ∏, œï</code> because it allocates large arrays and performs many calculations that could be reused.  If you need to evaluate the matrices for many values of <code>R</code> or <code>Œ∏, œï</code>, you should pre-allocate the storage with <a href="#SphericalFunctions.sYlm_prep"><code>sYlm_prep</code></a>, and then call <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a> with the result instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/SphericalFunctions.jl/blob/16e80697070b409a669520ad87b3516d94616328/src/evaluate.jl#L376-L391">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFunctions.sYlm_values!" href="#SphericalFunctions.sYlm_values!"><code>SphericalFunctions.sYlm_values!</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sYlm_values!(sYlm_storage, R, spin)
sYlm_values!(sYlm_storage, Œ∏, œï, spin)
sYlm_values!(sYlm, R, ‚Ñì‚Çò‚Çê‚Çì, spin)
sYlm_values!(sYlm, Œ∏, œï, ‚Ñì‚Çò‚Çê‚Çì, spin)</code></pre><p>Compute values of the spin-weighted spherical harmonic <span>${}_{s}Y_{\ell, m}(R)$</span> for all <span>$\ell \leq \ell_\mathrm{max}$</span>.</p><p>The spherical harmonics of spin weight <span>$s$</span> are related to Wigner&#39;s <span>$\mathfrak{D}$</span> matrix as</p><p class="math-container">\[\begin{aligned}
{}_{s}Y_{\ell, m}(R)
  &amp;= (-1)^s \sqrt{\frac{2\ell+1}{4\pi}} \mathfrak{D}^{(\ell)}_{m, -s}(R) \\
  &amp;= (-1)^s \sqrt{\frac{2\ell+1}{4\pi}} \bar{\mathfrak{D}}^{(\ell)}_{-s, m}(\bar{R}).
\end{aligned}\]</p><p>In all cases, the result is returned in a 1-dimensional array ordered as</p><pre><code class="nohighlight hljs">[
    ‚ÇõY‚Çó‚Çò(R)
    for ‚Ñì ‚àà 0:‚Ñì‚Çò‚Çê‚Çì
    for m ‚àà -‚Ñì:‚Ñì
]</code></pre><p>When the first argument is <code>Y</code>, it will be modified, so it must be at least as large as that array. When the first argument is <code>sYlm_storage</code>, it should be the quantity returned by <a href="#SphericalFunctions.sYlm_prep"><code>sYlm_prep</code></a>, and the result will be written into the <code>Y</code> field of that tuple.  Both of these options ‚Äî especially the latter ‚Äî reduce the number of allocations needed on each call to the corresponding functions, which should increase the speed significantly.  Note that the <code>Y</code> or <code>sYlm_storage</code> arguments must have types compatible with the type of <code>R</code> or <code>Œ∏, œï</code>.</p><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>When using the <code>sYlm_storage</code> argument (which is recommended), the returned quantity <code>sYlm</code> will be an alias of <code>sYlm_storage[1]</code>.  If you want to retain that data after the next call to <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a>, you should copy it with <code>copy(sYlm)</code>.</p></div></div><p>The <code>Œ∏, œï</code> arguments are spherical coordinates as described in the documentation of <a href="https://moble.github.io/Quaternionic.jl/dev/manual/#Quaternionic.from_spherical_coordinates-Tuple{Any,%20Any}"><code>Quaternionic.from_spherical_coordinates</code></a>.</p><p>See also <a href="#SphericalFunctions.sYlm_values"><code>sYlm_values</code></a> for a simpler function call when you only need to evaluate the <span>${}_{s}Y_{\ell, m}$</span> for a single value of <code>R</code> or <code>Œ∏, œï</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Quaternionic, SphericalFunctions
spin = -2
‚Ñì‚Çò‚Çê‚Çì = 8
T = Float64
R = Rotor{T}(1, 2, 3, 4)  # Will be normalized automatically
sYlm_storage = sYlm_prep(‚Ñì‚Çò‚Çê‚Çì, spin, T)
sYlm = sYlm_values!(sYlm_storage, R, spin)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/SphericalFunctions.jl/blob/16e80697070b409a669520ad87b3516d94616328/src/evaluate.jl#L402-L460">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFunctions.sYlm_prep" href="#SphericalFunctions.sYlm_prep"><code>SphericalFunctions.sYlm_prep</code></a> ‚Äî <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sYlm_prep(‚Ñì‚Çò‚Çê‚Çì, s‚Çò‚Çê‚Çì, [T=Float64, [‚Ñì‚Çò·µ¢‚Çô=0]])</code></pre><p>Construct storage space and pre-compute recursion coefficients to compute spin-weighted spherical-harmonic values <span>${}_{s}Y_{\ell, m}$</span> in place.</p><p>This returns the <code>sYlm_storage</code> arguments needed by <a href="#SphericalFunctions.sYlm_values!"><code>sYlm_values!</code></a>.</p><p>Note that the result of this function can be passed to <code>sYlm_values!</code>, even if the value of <code>spin</code> passed to that function is smaller (in absolute value) than the <code>s‚Çò‚Çê‚Çì</code> passed to this function.  That is, the <code>sYlm_storage</code> returned by this function can be used to compute <span>${}_{s}Y_{\ell, m}$</span> values for numerous values of the spin.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/SphericalFunctions.jl/blob/16e80697070b409a669520ad87b3516d94616328/src/evaluate.jl#L502-L515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SphericalFunctions.sYlm_iterator" href="#SphericalFunctions.sYlm_iterator"><code>SphericalFunctions.sYlm_iterator</code></a> ‚Äî <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sYlm_iterator(Y, ‚Ñì‚Çò‚Çê‚Çì, [‚Ñì‚Çò·µ¢‚Çô, [i‚Çò·µ¢‚Çô]])</code></pre><p>Construct an Iterator that returns sub-vectors of <code>Y</code>, each of which consists of elements <span>$(‚Ñì,-‚Ñì)$</span> through <span>$(‚Ñì,‚Ñì)$</span>, for <span>$‚Ñì$</span> from <code>‚Ñì‚Çò·µ¢‚Çô</code> through <code>‚Ñì‚Çò‚Çê‚Çì</code>.</p><p>Note that the returned objects are <em>views</em> into the original <code>Y</code> data ‚Äî meaning that you may alter their values.</p><p>Because the result is a vector restricted to a particular <span>$‚Ñì$</span> value, you can index the <span>$(‚Ñì, m)$</span> element as <code>[‚Ñì+m+1]</code>.  For example, you might use this as something like</p><pre><code class="nohighlight hljs">for (‚Ñì, YÀ°) in zip(‚Ñì‚Çò·µ¢‚Çô:‚Ñì‚Çò‚Çê‚Çì, sYlm_iterator(Y, ‚Ñì‚Çò‚Çê‚Çì))
    for m in -‚Ñì:‚Ñì
        YÀ°[‚Ñì+m+1]  # ... do something with YÀ°
    end
end</code></pre><p>By default, <code>Y</code> is assumed to contain all possible values, beginning with <code>(0,0)</code>.  However, if <code>‚Ñì‚Çò·µ¢‚Çô</code> is not 0, this can be ambiguous: do we mean that <code>Y</code> really starts with the <code>(0,0)</code> element and we are just asking to begin the iteration higher?  Or do we mean that <code>Y</code> doesn&#39;t even contain data for lower <code>‚Ñì</code> values?  We can resolve this using <code>i‚Çò·µ¢‚Çô</code>, which gives the index of <code>‚Ñì‚Çò·µ¢‚Çô</code> in <code>Y</code>.  By default, we assume the first case, and set <code>i‚Çò·µ¢‚Çô=Ysize(‚Ñì‚Çò·µ¢‚Çô-1)+1</code>. However, if <code>Y</code> doesn&#39;t contain data below <code>‚Ñì‚Çò·µ¢‚Çô</code>, we could use <code>i‚Çò·µ¢‚Çô=1</code> to indicate the index in <code>Y</code> at which to find <span>$(‚Ñì‚Çò·µ¢‚Çô,-‚Ñì‚Çò·µ¢‚Çô)$</span>.</p><p>Also note that no bounds checking is done, either at instantiation time or during iteration.  You are responsible for ensuring that the size of <code>Y</code> and the values of <code>‚Ñì‚Çò‚Çê‚Çì</code>, <code>‚Ñì‚Çò·µ¢‚Çô</code>, and <code>i‚Çò·µ¢‚Çô</code> make sense.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/moble/SphericalFunctions.jl/blob/16e80697070b409a669520ad87b3516d94616328/src/iterators.jl#L159-L191">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../wigner_matrices/">¬´ Wigner&#39;s <span>$ùîá$</span> and <span>$d$</span> matrices</a><a class="docs-footer-nextpage" href="../operators/">Differential operators ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Thursday 6 February 2025 14:01">Thursday 6 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
